(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    139201,       3305]
NotebookOptionsPosition[    134982,       3162]
NotebookOutlinePosition[    135328,       3177]
CellTagsIndexPosition[    135285,       3174]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Chomsky normal form and CKY algorithm", "Subchapter",
 CellChangeTimes->{{3.6415344286344433`*^9, 3.64153444028611*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Backslash", "=", "Complement"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6367841146395144`*^9, 3.6367843176221247`*^9}, {
  3.636784356096325*^9, 3.636784748095746*^9}, {3.6367855914009805`*^9, 
  3.636785648168227*^9}, {3.6367857343441563`*^9, 3.6367858333938217`*^9}, {
  3.6367859318894553`*^9, 3.636785935161642*^9}, {3.636786786971363*^9, 
  3.6367868396393757`*^9}, {3.636800481016714*^9, 3.6368005045470595`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pairs", "@", "G_"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"List", ",", "##"}], "]"}], "&"}], "@@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"#", ",", "\"\<|\>\"", ",", "All"}], "]"}], "&"}], "/@", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"G", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\< \[Rule] \>\"", ",", "\"\< \[Rule]\>\"", ",", 
           "\"\<\[Rule] \>\"", ",", "\"\<\[Rule]\>\""}], "}"}], ",", "2"}], 
        "]"}]}], ")"}]}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BNF", "@", "G_"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"First", "@", "#"}], "<>", "\"\< \[Rule] \>\"", "<>", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"Rest", "@", "#"}], ",", "\"\<|\>\""}], "]"}]}], "&"}], ",", 
    RowBox[{"G", "  ", "//.", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x___", ",", 
        RowBox[{"{", 
         RowBox[{"A_", ",", "B__"}], "}"}], ",", "y___", ",", 
        RowBox[{"{", 
         RowBox[{"A_", ",", "C__"}], "}"}], ",", "z___"}], "}"}], 
      "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "B", ",", "C"}], "}"}], ",", "y", ",", "z"}], 
       "}"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6367841146395144`*^9, 3.6367843176221247`*^9}, {
  3.636784356096325*^9, 3.636784748095746*^9}, {3.6367855914009805`*^9, 
  3.636785648168227*^9}, {3.6367857343441563`*^9, 3.6367858333938217`*^9}, {
  3.6367859318894553`*^9, 3.636785935161642*^9}, {3.636786786971363*^9, 
  3.6367868278587017`*^9}, {3.6367870012386184`*^9, 3.6367870055448647`*^9}, {
  3.6367871012403383`*^9, 3.6367871779717274`*^9}, {3.6367873168786716`*^9, 
  3.6367874490442314`*^9}, {3.6367875376563*^9, 3.636787537890313*^9}, {
  3.636790187172844*^9, 3.6367902339205174`*^9}, {3.6367902681504755`*^9, 
  3.636790308013755*^9}, {3.6368013847964067`*^9, 3.636801385095424*^9}, {
  3.636814379199644*^9, 3.6368143871681004`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"Pairs", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]ABbaDS|S|Cb|A|C|aJ\>\"", ",", 
        "\"\<A\[Rule]S|BC|b|F|\[CurlyEpsilon]\>\"", ",", "\"\<B\[Rule]ac\>\"",
         ",", "\"\<B\[Rule]ac|ac\>\"", ",", "\"\<C\[Rule]S|D\>\"", ",", 
        "\"\<E\[Rule]abS|cc\>\"", ",", "\"\<F\[Rule]A\>\"", ",", 
        "\"\<G\[Rule]H|H|G\>\"", ",", "\"\<H\[Rule]G|I|H|abc\>\"", ",", 
        "\"\<J\[Rule]J\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]a|Xb|aYa\>\"", ",", "\"\<X\[Rule]Y|\[CurlyEpsilon]\>\"", 
        ",", "\"\<Y\[Rule]b|X\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]SS|AB|b\>\"", ",", "\"\<B\[Rule]SB|b\>\"", ",", 
        "\"\<A\[Rule]a\>\""}], "}"}], ",", 
      RowBox[{"{", "\"\<S\[Rule]aSa|bSb|\[CurlyEpsilon]\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]a|Xb|aYa\>\"", ",", "\"\<X\[Rule]Y|\[CurlyEpsilon]\>\"", 
        ",", "\"\<Y\[Rule]b|X\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]XY\>\"", ",", "\"\<X\[Rule]Zb\>\"", ",", 
        "\"\<Y\[Rule]bW\>\"", ",", "\"\<Z\[Rule]AB\>\"", ",", 
        "\"\<W\[Rule]Z\>\"", ",", "\"\<A\[Rule]aA|bA|\[CurlyEpsilon]\>\"", 
        ",", "\"\<B\[Rule]Ba|Bb|\[CurlyEpsilon]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]Xab|YY|aX|ZYX\>\"", ",", "\"\<X\[Rule]Za|bZ|ZZ|Yb\>\"", 
        ",", "\"\<Y\[Rule]Ya|XY|\[CurlyEpsilon]\>\"", ",", 
        "\"\<Z\[Rule]aX|YYY\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]A|bb\>\"", ",", "\"\<A\[Rule]B|b\>\"", ",", 
        "\"\<B\[Rule]S|a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]XY\>\"", ",", "\"\<X\[Rule]XX|A\>\"", ",", 
        "\"\<Y\[Rule]YY|B\>\"", ",", "\"\<A\[Rule]a\>\"", ",", 
        "\"\<B\[Rule]b\>\""}], "}"}], ",", 
      RowBox[{"{", "\"\<S\[Rule]aSa|bSb|a|b|\[CurlyEpsilon]\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]bA|aB\>\"", ",", "\"\<A\[Rule]bAA|aS|a\>\"", ",", 
        "\"\<B\[Rule]aBB|bS|b\>\""}], "}"}], ",", 
      RowBox[{"{", "\"\<S\[Rule]aaaaS|aaaa\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]ABABA\>\"", ",", "\"\<A\[Rule]a|\[CurlyEpsilon]\>\"", 
        ",", "\"\<B\[Rule]b|\[CurlyEpsilon]\>\""}], "}"}], ",", 
      RowBox[{"{", "\"\<S\[Rule]SS|a\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\[Rule]SS|AB|b\>\"", ",", "\"\<B\[Rule]SB|b\>\"", ",", 
        "\"\<A\[Rule]a\>\""}], "}"}], ",", 
      RowBox[{
      "{", "\"\<S\[Rule](S)|(S*S)|(S+S)|(S\[Rule]S)|(S/S)|(a)|(b)\>\"", 
       "}"}]}], "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.6368144198109674`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "G"}]}], ",", "G"}], "}"}], "\[Transpose]"}], 
   ",", 
   RowBox[{"Alignment", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"Right", ",", "Left"}], "}"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6367867420977964`*^9, 3.636786764314067*^9}, {
   3.6367869128415623`*^9, 3.6367869354288545`*^9}, {3.636786966801649*^9, 
   3.6367869763761964`*^9}, {3.6367870123192525`*^9, 3.636787021686788*^9}, {
   3.6367879581503506`*^9, 3.6367881669872956`*^9}, {3.6367901800424356`*^9, 
   3.6367901808254805`*^9}, 3.6368014269808197`*^9, {3.6368019290445366`*^9, 
   3.6368019297325754`*^9}, {3.6368041997404127`*^9, 3.636804212381136*^9}, {
   3.6368144097773933`*^9, 3.6368144417242203`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"ABbaDS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"S\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"Cb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"A\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"C\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"S\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"BC\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"F\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"ac\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"ac\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"ac\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"C\"\>", ",", "\<\"S\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"C\"\>", ",", "\<\"D\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"E\"\>", ",", "\<\"abS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"E\"\>", ",", "\<\"cc\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"F\"\>", ",", "\<\"A\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"G\"\>", ",", "\<\"H\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"G\"\>", ",", "\<\"H\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"G\"\>", ",", "\<\"G\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"G\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"I\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"H\"\>", ",", "\<\"abc\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", ",", "\<\"J\"\>"}], "}"}]}], "}"}]},
    {"2", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"Xb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aYa\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"X\"\>"}], "}"}]}], "}"}]},
    {"3", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"AB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"SB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}]}], "}"}]},
    {"4", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aSa\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"bSb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}]}], "}"}]},
    {"5", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"Xb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aYa\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"X\"\>"}], "}"}]}], "}"}]},
    {"6", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"XY\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"Zb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"bW\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Z\"\>", ",", "\<\"AB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"W\"\>", ",", "\<\"Z\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"aA\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"bA\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"Ba\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"Bb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}]}], "}"}]},
    {"7", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"Xab\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"YY\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aX\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"ZYX\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"Za\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"bZ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"ZZ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"Yb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"Ya\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"XY\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Z\"\>", ",", "\<\"aX\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Z\"\>", ",", "\<\"YYY\"\>"}], "}"}]}], "}"}]},
    {"8", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"A\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"bb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"a\"\>"}], "}"}]}], "}"}]},
    {"9", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"XY\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"XX\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"X\"\>", ",", "\<\"A\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"YY\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"Y\"\>", ",", "\<\"B\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}]}], "}"}]},
    {"10", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aSa\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"bSb\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}]}], "}"}]},
    {"11", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"bA\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"bAA\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"aS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"aBB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"bS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}]}], "}"}]},
    {"12", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aaaaS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"aaaa\"\>"}], "}"}]}], "}"}]},
    {"13", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"ABABA\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"\[CurlyEpsilon]\"\>"}], "}"}]}], "}"}]},
    {"14", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"a\"\>"}], "}"}]}], "}"}]},
    {"15", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"AB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"SB\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}]}], "}"}]},
    {"16", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(S)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(S*S)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(S+S)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(S\[Rule]S)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(S/S)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(a)\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"(b)\"\>"}], "}"}]}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {Right, Left}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.636786918763901*^9, 3.6367869770592356`*^9, {3.6367870079700036`*^9, 
   3.636787022228819*^9}, 3.6367870801111298`*^9, 3.6367874533434772`*^9, {
   3.6367880626873302`*^9, 3.636788078349226*^9}, {3.6367881317382793`*^9, 
   3.636788167469323*^9}, 3.636790316560244*^9, 3.636797636592022*^9, 
   3.636800507054203*^9, 3.636801428682917*^9, 3.6368019311136546`*^9, {
   3.6368042009244804`*^9, 3.63680421386522*^9}, {3.636814423943204*^9, 
   3.6368144429422903`*^9}}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "ReachableV"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReachableV", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "=", 
      RowBox[{"{", "\"\<S\>\"", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "\[Function]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Scan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"G", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "x_"}], "}"}], "\[RuleDelayed]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"m", ",", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"Characters", "@", "x"}], ",", "UpperCaseQ"}], 
                  "]"}]}], "]"}]}]}], "]"}], "&"}], ",", "\[Mu]"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Union", "@", 
          RowBox[{"Flatten", "@", "m"}]}]}], ")"}]}], ",", "m"}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6367858514318533`*^9, 3.636785871550004*^9}, {
   3.6367859390798664`*^9, 3.63678593949089*^9}, {3.6367860019914646`*^9, 
   3.636786088241398*^9}, {3.6367861751023664`*^9, 3.6367862068331814`*^9}, {
   3.636786248230549*^9, 3.636786249728635*^9}, {3.636786301006568*^9, 
   3.6367863211597204`*^9}, {3.63678657938549*^9, 3.6367865987885995`*^9}, {
   3.6367866531587095`*^9, 3.6367866751749687`*^9}, {3.636787941303387*^9, 
   3.636787945149607*^9}, {3.6367881834372363`*^9, 3.63678827686158*^9}, {
   3.6367883198950415`*^9, 3.636788320312065*^9}, {3.636788374493164*^9, 
   3.6367884403469305`*^9}, {3.6367884769230227`*^9, 3.636788490426795*^9}, {
   3.6367885283669653`*^9, 3.636788602424201*^9}, {3.6367886344640336`*^9, 
   3.636788709774341*^9}, {3.636788750542673*^9, 3.6367888204156694`*^9}, {
   3.6367888513294373`*^9, 3.6367889758135576`*^9}, {3.636789005836275*^9, 
   3.6367890202621*^9}, 3.636790990974818*^9, {3.6367960175174165`*^9, 
   3.636796027246973*^9}, 3.6367960757507467`*^9, {3.6367961122828364`*^9, 
   3.63679611812117*^9}, {3.6367976390481625`*^9, 3.636797647698657*^9}, 
   3.6368144558470287`*^9, {3.6368147667908134`*^9, 3.6368147707800417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReachableV", "@", 
  RowBox[{
  "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6367858514318533`*^9, 3.636785871550004*^9}, {
   3.6367859390798664`*^9, 3.63678593949089*^9}, {3.6367860019914646`*^9, 
   3.636786088241398*^9}, {3.6367861751023664`*^9, 3.6367862068331814`*^9}, {
   3.636786248230549*^9, 3.636786249728635*^9}, {3.636786301006568*^9, 
   3.6367863211597204`*^9}, {3.63678657938549*^9, 3.6367865987885995`*^9}, {
   3.6367866531587095`*^9, 3.6367866751749687`*^9}, {3.636787941303387*^9, 
   3.636787945149607*^9}, {3.6367881834372363`*^9, 3.63678827686158*^9}, {
   3.6367883198950415`*^9, 3.636788320312065*^9}, {3.636788374493164*^9, 
   3.6367884403469305`*^9}, {3.6367884769230227`*^9, 3.636788490426795*^9}, {
   3.6367885283669653`*^9, 3.636788602424201*^9}, {3.6367886344640336`*^9, 
   3.636788709774341*^9}, {3.636788750542673*^9, 3.6367888204156694`*^9}, {
   3.6367888513294373`*^9, 3.6367889758135576`*^9}, {3.636789005836275*^9, 
   3.6367890202621*^9}, 3.636790990974818*^9, {3.6367960175174165`*^9, 
   3.636796027246973*^9}, 3.6367960757507467`*^9, {3.6367961122828364`*^9, 
   3.63679611812117*^9}, {3.6367976390481625`*^9, 3.636797647698657*^9}, 
   3.6368144558470287`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"C\"\>", ",", "\<\"D\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"J\"\>", ",", "\<\"S\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.636788256531417*^9, 3.6367882774686146`*^9}, 
   3.636788345910529*^9, {3.6367883782193775`*^9, 3.636788397914504*^9}, 
   3.636788509885908*^9, {3.636788564907055*^9, 3.636788604211303*^9}, {
   3.6367887538758636`*^9, 3.6367888210137033`*^9}, {3.6367889317050347`*^9, 
   3.6367889812098665`*^9}, {3.6367890168249035`*^9, 3.6367890209511395`*^9}, 
   3.6367903214995265`*^9, {3.636796002860578*^9, 3.636796028097021*^9}, {
   3.6367961148339825`*^9, 3.6367961185961976`*^9}, {3.636797629647625*^9, 
   3.6367976582272596`*^9}, 3.6368005097073545`*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "MapAtAllLast"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapAtAllLast", "[", 
   RowBox[{"f_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"l", "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"MapAt", "[", 
     RowBox[{"f", ",", "l", ",", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636799570528637*^9, 3.636799698688967*^9}, {
   3.636799729634737*^9, 3.6367997299567556`*^9}, 3.6368144709248905`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MapAtAllLast", "[", 
  RowBox[{"f", ",", 
   RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MapAtAllLast", "[", 
  RowBox[{"f", ",", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"\"\<\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.636799570528637*^9, 3.636799698688967*^9}, {
   3.636799729634737*^9, 3.6367997299567556`*^9}, 3.6368144709248905`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.6367996741825657`*^9, 3.636799698927981*^9}, 
   3.636799730745801*^9, 3.6368005116104636`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"\"\>", ",", 
     RowBox[{"f", "[", "\<\"\"\>", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"\"\>", ",", 
     RowBox[{"f", "[", "\<\"\"\>", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"\"\>", ",", 
     RowBox[{"f", "[", "\<\"\"\>", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"\"\>", ",", 
     RowBox[{"f", "[", "\<\"\"\>", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6367996741825657`*^9, 3.636799698927981*^9}, 
   3.636799730745801*^9, 3.636800511613464*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "TerminatingV"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TerminatingV", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"m", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Last", "@", 
      RowBox[{"Reap", "@", 
       RowBox[{"FixedPoint", "[", 
        RowBox[{
         RowBox[{"g", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Sow", "[", 
             RowBox[{"t", "=", 
              RowBox[{"Union", "@", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"g", ",", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"AnyTrue", "[", 
                    RowBox[{
                    RowBox[{"Characters", "@", 
                    RowBox[{"Last", "@", "#"}]}], ",", "UpperCaseQ"}], 
                    "]"}]}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"MapAtAllLast", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"t", "\[Rule]", "\"\<a\>\""}], "]"}]}], "]"}], 
               "&"}], ",", 
              RowBox[{"Select", "[", 
               RowBox[{"g", ",", 
                RowBox[{
                 RowBox[{"Not", "@", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"t", ",", 
                    RowBox[{"First", "@", "#"}]}], "]"}]}], "&"}]}], "]"}]}], 
             "]"}]}], ")"}]}], ",", "G"}], "]"}]}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636789077989402*^9, 3.6367890871359253`*^9}, {
   3.6367891254371157`*^9, 3.6367892579016924`*^9}, {3.6367892916766243`*^9, 
   3.6367893014541836`*^9}, {3.636789460791297*^9, 3.636789461010309*^9}, 
   3.636790096910681*^9, {3.636790350545188*^9, 3.636790449062823*^9}, {
   3.6367904908782144`*^9, 3.636790561246239*^9}, {3.636790658152782*^9, 
   3.636790662381024*^9}, {3.6367906974060273`*^9, 3.6367907250016055`*^9}, {
   3.6367908294315786`*^9, 3.6367908906420794`*^9}, {3.636791258981148*^9, 
   3.6367912892888813`*^9}, {3.636795303142556*^9, 3.6367953098389397`*^9}, {
   3.6367953512203064`*^9, 3.636795380378974*^9}, {3.636795438909322*^9, 
   3.636795491455327*^9}, {3.636795554311922*^9, 3.6367955741260557`*^9}, {
   3.6367958325918393`*^9, 3.63679584030228*^9}, {3.6367961391693745`*^9, 
   3.6367961808927608`*^9}, {3.636797652031905*^9, 3.636797656440157*^9}, {
   3.6367976903930993`*^9, 3.636797712808381*^9}, {3.6367977428541*^9, 
   3.6367977714827375`*^9}, {3.6367978236717224`*^9, 3.636797882321077*^9}, {
   3.6367979641907597`*^9, 3.636798063205423*^9}, {3.6367981635911646`*^9, 
   3.6367982109698744`*^9}, {3.636798242948704*^9, 3.636798334378933*^9}, {
   3.636798364896679*^9, 3.6367986505920196`*^9}, {3.6367986932244577`*^9, 
   3.6367987567310905`*^9}, {3.63679886722941*^9, 3.6367989106448936`*^9}, {
   3.6367989417936754`*^9, 3.636799068260909*^9}, {3.6367991149335785`*^9, 
   3.636799311407816*^9}, {3.636799530229332*^9, 3.6367995659853773`*^9}, {
   3.6367997220653048`*^9, 3.6367997607785187`*^9}, {3.636804077553424*^9, 
   3.6368040841378*^9}, {3.63680422348077*^9, 3.6368042260319166`*^9}, {
   3.636804297617011*^9, 3.6368043194982624`*^9}, {3.6368043978797455`*^9, 
   3.6368044424502945`*^9}, 3.6368144769392347`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TerminatingV", "@", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
    RowBox[{"Apply", "@", "Unequal"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.636789077989402*^9, 3.6367890871359253`*^9}, {
   3.6367891254371157`*^9, 3.6367892579016924`*^9}, {3.6367892916766243`*^9, 
   3.6367893014541836`*^9}, {3.636789460791297*^9, 3.636789461010309*^9}, 
   3.636790096910681*^9, {3.636790350545188*^9, 3.636790449062823*^9}, {
   3.6367904908782144`*^9, 3.636790561246239*^9}, {3.636790658152782*^9, 
   3.636790662381024*^9}, {3.6367906974060273`*^9, 3.6367907250016055`*^9}, {
   3.6367908294315786`*^9, 3.6367908906420794`*^9}, {3.636791258981148*^9, 
   3.6367912892888813`*^9}, {3.636795303142556*^9, 3.6367953098389397`*^9}, {
   3.6367953512203064`*^9, 3.636795380378974*^9}, {3.636795438909322*^9, 
   3.636795491455327*^9}, {3.636795554311922*^9, 3.6367955741260557`*^9}, {
   3.6367958325918393`*^9, 3.63679584030228*^9}, {3.6367961391693745`*^9, 
   3.6367961808927608`*^9}, {3.636797652031905*^9, 3.636797656440157*^9}, {
   3.6367976903930993`*^9, 3.636797712808381*^9}, {3.6367977428541*^9, 
   3.6367977714827375`*^9}, {3.6367978236717224`*^9, 3.636797882321077*^9}, {
   3.6367979641907597`*^9, 3.636798063205423*^9}, {3.6367981635911646`*^9, 
   3.6367982109698744`*^9}, {3.636798242948704*^9, 3.636798334378933*^9}, {
   3.636798364896679*^9, 3.6367986505920196`*^9}, {3.6367986932244577`*^9, 
   3.6367987567310905`*^9}, {3.63679886722941*^9, 3.6367989106448936`*^9}, {
   3.6367989417936754`*^9, 3.636799068260909*^9}, {3.6367991149335785`*^9, 
   3.636799311407816*^9}, {3.636799530229332*^9, 3.6367995659853773`*^9}, {
   3.6367997220653048`*^9, 3.6367997607785187`*^9}, {3.636804077553424*^9, 
   3.6368040841378*^9}, {3.63680422348077*^9, 3.6368042260319166`*^9}, {
   3.636804297617011*^9, 3.6368043194982624`*^9}, {3.6368043978797455`*^9, 
   3.6368044424502945`*^9}, 3.6368144769392347`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"E\"\>", ",", "\<\"H\"\>", 
   ",", "\<\"F\"\>", ",", "\<\"G\"\>", ",", "\<\"S\"\>", ",", "\<\"C\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6368040843628135`*^9, 3.6368042050087137`*^9, {3.6368044173568597`*^9, 
   3.636804446613533*^9}, 3.636804517774603*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "EliminateUselessP"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EliminateUselessP", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "V", ",", "\[DoubleStruckCapitalG]", ",", "nt"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{"g", "\[Function]", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"V", "=", 
          RowBox[{"Union", "@", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Flatten", "@", 
              RowBox[{"MapAtAllLast", "[", 
               RowBox[{"Characters", ",", "g"}], "]"}]}], ",", "UpperCaseQ"}],
             "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[DoubleStruckCapitalG]", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"g", ",", 
            RowBox[{"Apply", "@", "Unequal"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          OverscriptBox["t", "_"], "=", 
          RowBox[{"V", "\[Backslash]", 
           RowBox[{"(", 
            RowBox[{"t", "=", 
             RowBox[{"TerminatingV", "@", "\[DoubleStruckCapitalG]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", 
          RowBox[{"\[DoubleStruckCapitalG]", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ReachableV", "@", "\[DoubleStruckCapitalG]"}], 
                "\[Intersection]", "t"}], ",", 
               RowBox[{"First", "@", "#"}]}], "]"}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"Characters", "@", 
                RowBox[{"Last", "@", "#"}]}], "\[Intersection]", 
               OverscriptBox["t", "_"]}], "\[Equal]", 
              RowBox[{"{", "}"}]}]}], "&"}]}], "]"}]}], ")"}]}], ",", 
      RowBox[{"Union", "@", "G"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6367958464636326`*^9, 3.6367958676528444`*^9}, {
   3.6367959009177475`*^9, 3.63679590342389*^9}, {3.636795962250255*^9, 
   3.636795986217626*^9}, {3.6367963883136244`*^9, 3.6367964473029985`*^9}, {
   3.636796484317116*^9, 3.6367965290186725`*^9}, {3.6367994106474924`*^9, 
   3.6367994953393364`*^9}, {3.636799795981532*^9, 3.6367999762638435`*^9}, {
   3.636800118410974*^9, 3.6368001605173826`*^9}, {3.6368005185338593`*^9, 
   3.6368005212410145`*^9}, {3.636800556990059*^9, 3.6368005581361246`*^9}, {
   3.636800934141631*^9, 3.6368009718397875`*^9}, {3.636801014837247*^9, 
   3.636801042112807*^9}, {3.636801085582293*^9, 3.6368010952098436`*^9}, {
   3.6368011614886346`*^9, 3.6368012141146445`*^9}, {3.636801275018128*^9, 
   3.6368012759221797`*^9}, {3.636801364780262*^9, 3.636801371978674*^9}, {
   3.636801527675579*^9, 3.636801528470625*^9}, {3.636803384279771*^9, 
   3.6368033902311115`*^9}, {3.636804930924234*^9, 3.636804960600931*^9}, {
   3.6368081149233484`*^9, 3.6368081173884892`*^9}, 3.6368144863237715`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Union", "@", 
  RowBox[{"BNF", "@", 
   RowBox[{
   "G", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"BNF", "@", 
  RowBox[{"EliminateUselessP", "@", 
   RowBox[{
   "G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6367958464636326`*^9, 3.6367958676528444`*^9}, {
   3.6367959009177475`*^9, 3.63679590342389*^9}, {3.636795962250255*^9, 
   3.636795986217626*^9}, {3.6367963883136244`*^9, 3.6367964473029985`*^9}, {
   3.636796484317116*^9, 3.6367965290186725`*^9}, {3.6367994106474924`*^9, 
   3.6367994953393364`*^9}, {3.636799795981532*^9, 3.6367999762638435`*^9}, {
   3.636800118410974*^9, 3.6368001605173826`*^9}, {3.6368005185338593`*^9, 
   3.6368005212410145`*^9}, {3.636800556990059*^9, 3.6368005581361246`*^9}, {
   3.636800934141631*^9, 3.6368009718397875`*^9}, {3.636801014837247*^9, 
   3.636801042112807*^9}, {3.636801085582293*^9, 3.6368010952098436`*^9}, {
   3.6368011614886346`*^9, 3.6368012141146445`*^9}, {3.636801275018128*^9, 
   3.6368012759221797`*^9}, {3.636801364780262*^9, 3.636801371978674*^9}, {
   3.636801527675579*^9, 3.636801528470625*^9}, {3.636803384279771*^9, 
   3.6368033902311115`*^9}, {3.636804930924234*^9, 3.636804960600931*^9}, {
   3.6368081149233484`*^9, 3.6368081173884892`*^9}, 3.6368144863237715`*^9, {
   3.6368148004407377`*^9, 3.63681480082476*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A \[Rule] S|BC|b|F|\[CurlyEpsilon]\"\>", 
   ",", "\<\"B \[Rule] ac|ac|ac\"\>", ",", "\<\"C \[Rule] S|D\"\>", 
   ",", "\<\"E \[Rule] abS|cc\"\>", ",", "\<\"F \[Rule] A\"\>", 
   ",", "\<\"G \[Rule] H|H|G\"\>", ",", "\<\"H \[Rule] G|I|H|abc\"\>", 
   ",", "\<\"J \[Rule] J\"\>", ",", "\<\"S \[Rule] ABbaDS|S|Cb|A|C|aJ\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.636797563145821*^9, 3.636797663847581*^9, 3.636797727354213*^9, 
   3.63679782922104*^9, {3.6367978611748676`*^9, 3.636797885720271*^9}, 
   3.636799316755122*^9, {3.636799470957942*^9, 3.636799495857366*^9}, {
   3.636799884915619*^9, 3.636799890862959*^9}, 3.636800522985114*^9, {
   3.6368009580439982`*^9, 3.6368009722358103`*^9}, 3.6368010964959173`*^9, {
   3.6368011901322727`*^9, 3.6368012169498067`*^9}, {3.6368013568418083`*^9, 
   3.636801392992876*^9}, 3.6368014464789352`*^9, 3.6368034185387306`*^9, {
   3.6368049440479846`*^9, 3.636804961050957*^9}, 3.6368081278310866`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"A \[Rule] b|BC|F|S|\[CurlyEpsilon]\"\>", 
   ",", "\<\"B \[Rule] ac\"\>", ",", "\<\"C \[Rule] S\"\>", 
   ",", "\<\"F \[Rule] A\"\>", ",", "\<\"S \[Rule] A|C|Cb\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.636797563145821*^9, 3.636797663847581*^9, 3.636797727354213*^9, 
   3.63679782922104*^9, {3.6367978611748676`*^9, 3.636797885720271*^9}, 
   3.636799316755122*^9, {3.636799470957942*^9, 3.636799495857366*^9}, {
   3.636799884915619*^9, 3.636799890862959*^9}, 3.636800522985114*^9, {
   3.6368009580439982`*^9, 3.6368009722358103`*^9}, 3.6368010964959173`*^9, {
   3.6368011901322727`*^9, 3.6368012169498067`*^9}, {3.6368013568418083`*^9, 
   3.636801392992876*^9}, 3.6368014464789352`*^9, 3.6368034185387306`*^9, {
   3.6368049440479846`*^9, 3.636804961050957*^9}, 3.636808127852088*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BNF", "@", 
  RowBox[{"EliminateUselessP", "@", 
   RowBox[{"Pairs", "@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<S\[Rule]AB|C\>\"", ",", "\"\<A\[Rule]aA|a\>\"", ",", 
      "\"\<B\[Rule]bB\>\"", ",", "\"\<C\[Rule]c\>\""}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.636805008275658*^9, 3.6368050524711857`*^9}, {
  3.6368050928504953`*^9, 3.636805102663057*^9}, {3.636808125533955*^9, 
  3.636808125840973*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"C \[Rule] c\"\>", ",", "\<\"S \[Rule] C\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6368051039681315`*^9, 3.636808129328172*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "NullableV"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NullableV", "@", "G_"}], ":=", 
  RowBox[{
   RowBox[{"{", "}"}], "/;", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"G", ",", 
     RowBox[{"{", 
      RowBox[{"_", ",", "\"\<\[CurlyEpsilon]\>\""}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NullableV", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[DoubleStruckCapitalG]", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"G", ",", 
        RowBox[{
         RowBox[{"UpperCaseQ", "@", 
          RowBox[{"Last", "@", "#"}]}], "&"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{"\[Nu]", "\[Function]", 
       RowBox[{"Union", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"\[Nu]", ",", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"MapAtAllLast", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"\[Nu]", "\[Rule]", "\"\<\>\""}], "]"}]}], "]"}], 
               "&"}], ",", "\[DoubleStruckCapitalG]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"X_", ",", "\"\<\>\""}], "}"}], "\[Rule]", " ", "X"}]}],
            "]"}]}], "]"}]}]}], ",", 
      RowBox[{"Cases", "[", 
       RowBox[{"G", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"X_", ",", "\"\<\[CurlyEpsilon]\>\""}], "}"}], "\[Rule]", 
         "X"}]}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636801602134838*^9, 3.6368017106810465`*^9}, {
   3.636801862271717*^9, 3.636801895910641*^9}, {3.6368019362739496`*^9, 
   3.636801974319126*^9}, {3.6368020078720446`*^9, 3.6368021947947364`*^9}, {
   3.636802265596786*^9, 3.6368022801196165`*^9}, {3.6368023877407722`*^9, 
   3.6368023919860153`*^9}, {3.636802430998246*^9, 3.6368024328023496`*^9}, {
   3.6368025946496067`*^9, 3.6368026389141383`*^9}, {3.636802680996546*^9, 
   3.6368026982065296`*^9}, {3.636802732249477*^9, 3.636802746886314*^9}, {
   3.636802795618101*^9, 3.6368028601867943`*^9}, 3.6368144956253033`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"NullableV", "/@", "G"}], "]"}]], "Input",
 CellChangeTimes->{{3.636801602134838*^9, 3.6368017106810465`*^9}, {
   3.636801862271717*^9, 3.636801895910641*^9}, {3.6368019362739496`*^9, 
   3.636801974319126*^9}, {3.6368020078720446`*^9, 3.6368021947947364`*^9}, {
   3.636802265596786*^9, 3.6368022801196165`*^9}, {3.6368023877407722`*^9, 
   3.6368023919860153`*^9}, {3.636802430998246*^9, 3.6368024328023496`*^9}, {
   3.6368025946496067`*^9, 3.6368026389141383`*^9}, {3.636802680996546*^9, 
   3.6368026982065296`*^9}, {3.636802732249477*^9, 3.636802746886314*^9}, {
   3.636802795618101*^9, 3.6368028601867943`*^9}, 3.6368144956253033`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"C\"\>", ",", "\<\"F\"\>", 
       ",", "\<\"S\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "\<\"S\"\>", "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"W\"\>", 
       ",", "\<\"Z\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S\"\>", ",", "\<\"X\"\>", ",", "\<\"Y\"\>", 
       ",", "\<\"Z\"\>"}], "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "\<\"S\"\>", "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.636802705844967*^9, {3.63680273597269*^9, 3.6368027479163733`*^9}, {
   3.636802844779913*^9, 3.6368028605668163`*^9}, 3.6368045236379385`*^9, 
   3.6368081334614086`*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "EliminateNullableP"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EliminateNullableP", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalNu]", "=", 
       RowBox[{"NullableV", "@", "G"}]}], ",", "s", ",", "step1", ",", 
      "step2", ",", "u", ",", "v", ",", "w", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[CapitalNu]", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "@", "G"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"step1", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"u", ",", "v"}], "}"}], "=", "#"}], ";", 
           RowBox[{"s", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"\[CapitalNu]", ",", 
                 RowBox[{"StringTake", "[", 
                  RowBox[{"v", ",", 
                   RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"s", ",", "i"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"StringLength", "@", "v"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"u", ",", "v", ",", 
             RowBox[{"Rest", "@", 
              RowBox[{"Subsets", "@", "s"}]}]}], "}"}]}], ")"}], "&"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"Select", "[", 
         RowBox[{"G", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Characters", "@", 
              RowBox[{"Last", "@", "#"}]}], "\[Intersection]", 
             "\[CapitalNu]"}], "\[NotEqual]", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"step2", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"u", ",", "v", ",", "w"}], "}"}], "=", "#"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"u", ",", 
                RowBox[{"StringReplacePart", "[", 
                 RowBox[{"v", ",", "\"\<\>\"", ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#", ",", "#"}], "}"}], "\[Transpose]"}]}], 
                 "]"}]}], "}"}], "&"}], ",", "w"}], "]"}]}], ")"}], "&"}], 
        ",", "step1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"G", " ", "/.", " ", 
           RowBox[{"\"\<\[CurlyEpsilon]\>\"", "\[Rule]", " ", "\"\<\>\""}]}], 
          ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"step2", ",", "1"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "\"\<\>\""}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636803371756055*^9, 3.6368034705187035`*^9}, {
   3.63680351101902*^9, 3.636803519857526*^9}, {3.6368035629769917`*^9, 
   3.6368035688813295`*^9}, {3.6368036326209755`*^9, 3.636803649708953*^9}, 
   3.636804728448653*^9, 3.6368048042449884`*^9, {3.636805973361858*^9, 
   3.636805981407318*^9}, {3.6368060122060795`*^9, 3.636806071790488*^9}, {
   3.6368063091930666`*^9, 3.6368063413729067`*^9}, {3.6368063806471534`*^9, 
   3.6368063819952307`*^9}, {3.6368064286789007`*^9, 
   3.6368064420806675`*^9}, {3.6368081379906673`*^9, 3.6368081428269444`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Union", "@*", "BNF"}], "/@", 
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"EliminateNullableP", "@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"G", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}], 
   ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.636806384630381*^9, 3.6368064038044777`*^9}, {
  3.636806451980233*^9, 3.6368065359540367`*^9}, {3.636806961264363*^9, 
  3.636806966341653*^9}, {3.6368081457781134`*^9, 3.6368081461251326`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"A \[Rule] aA|bA|\[CurlyEpsilon]\"\>", "\<\"B \[Rule] Ba|Bb|\
\[CurlyEpsilon]\"\>", "\<\"S \[Rule] XY\"\>", "\<\"W \[Rule] Z\"\>", "\<\"X \
\[Rule] Zb\"\>", "\<\"Y \[Rule] bW\"\>", "\<\"Z \[Rule] AB\"\>"},
    {"\<\"A \[Rule] a|aA|b|bA\"\>", "\<\"B \[Rule] a|b|Ba|Bb\"\>", "\<\"S \
\[Rule] XY\"\>", "\<\"W \[Rule] Z\"\>", "\<\"X \[Rule] b|Zb\"\>", "\<\"Y \
\[Rule] b|bW\"\>", "\<\"Z \[Rule] A|AB|B\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.6368064042215014`*^9, {3.6368064468429394`*^9, 3.636806456381485*^9}, {
   3.636806509760538*^9, 3.636806536403062*^9}, {3.6368081467541685`*^9, 
   3.6368081512094235`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Union", "@*", "BNF"}], "/@", 
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"EliminateNullableP", "@", "#"}]}], "}"}]}], "&"}], "@", 
    RowBox[{"G", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
   ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6368081642471695`*^9, 3.636808164569188*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"S \[Rule] a|Xb|aYa\"\>", "\<\"X \[Rule] Y|\[CurlyEpsilon]\"\>", "\<\
\"Y \[Rule] b|X\"\>"},
    {"\<\"S \[Rule] a|aa|aYa|b|Xb\"\>", "\<\"X \[Rule] Y\"\>", "\<\"Y \[Rule] \
b|X\"\>"}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.636806968267763*^9, 3.6368081650572157`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"BNF", "/@", 
   RowBox[{"ComposeList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"EliminateNullableP", ",", "EliminateUselessP"}], "}"}], ",", 
     RowBox[{"Sort", "@", 
      RowBox[{"Pairs", "@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<S\[Rule]ABC\>\"", ",", "\"\<A\[Rule]aA|\[CurlyEpsilon]\>\"", 
         ",", "\"\<B\[Rule]bB|\[CurlyEpsilon]\>\"", ",", 
         "\"\<C\[Rule]\[CurlyEpsilon]\>\""}], "}"}]}]}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.636803371756055*^9, 3.6368034705187035`*^9}, {
   3.63680351101902*^9, 3.636803519857526*^9}, {3.6368035629769917`*^9, 
   3.6368035688813295`*^9}, {3.6368036326209755`*^9, 3.636803649708953*^9}, 
   3.636804728448653*^9, 3.6368048042449884`*^9, {3.636805973361858*^9, 
   3.636805981407318*^9}, {3.6368060122060795`*^9, 3.636806071790488*^9}, {
   3.6368063091930666`*^9, 3.6368063413729067`*^9}, {3.6368063806471534`*^9, 
   3.6368063819952307`*^9}, {3.6368065867489414`*^9, 3.63680659266928*^9}, {
   3.6368066372048273`*^9, 3.636806726480934*^9}, {3.636806767038254*^9, 
   3.6368069161527824`*^9}, {3.6368081677293687`*^9, 3.6368081700275*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"A \[Rule] aA|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] bB|\[CurlyEpsilon]\"\>", 
       ",", "\<\"C \[Rule] \[CurlyEpsilon]\"\>", 
       ",", "\<\"S \[Rule] ABC\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A \[Rule] a|aA\"\>", ",", "\<\"B \[Rule] b|bB\"\>", 
       ",", "\<\"S \[Rule] A|AB|ABC|AC|B|BC|C\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A \[Rule] a|aA\"\>", ",", "\<\"B \[Rule] b|bB\"\>", 
       ",", "\<\"S \[Rule] A|AB|B\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.636806034280342*^9, 3.6368063449621124`*^9, {3.6368065703600044`*^9, 
   3.636806593281315*^9}, 3.6368066504545856`*^9, 3.6368067756887484`*^9, {
   3.6368068214603662`*^9, 3.636806916654811*^9}, 3.6368081713845778`*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "TransitiveClosure"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransitiveClosure", "@", "G_"}], ":=", 
  RowBox[{"FixedPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"#", "~", "Join", "~", 
       RowBox[{"ReplaceList", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_"}], "}"}], ",", "___", ",", 
             RowBox[{"{", 
              RowBox[{"y_", ",", "z_"}], "}"}], ",", "___"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{"___", ",", 
             RowBox[{"{", 
              RowBox[{"y_", ",", "z_"}], "}"}], ",", "___", ",", 
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_"}], "}"}], ",", "___"}], "}"}]}], 
          "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "z"}], "}"}], "/;", 
           RowBox[{"x", "\[NotEqual]", "z"}]}]}]}], "]"}]}], "]"}], "&"}], 
    ",", "G", ",", 
    RowBox[{"SameTest", "\[Rule]", 
     RowBox[{"ArrayQ", "@*", "List"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"alternative", ":", "\[IndentingNewLine]", 
    RowBox[{"List", "@@@", 
     RowBox[{"EdgeList", "@", 
      RowBox[{"TransitiveClosureGraph", "@", 
       RowBox[{"Graph", "[", 
        RowBox[{"DirectedEdge", "@@@", "G"}], "]"}]}]}]}]}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6368078825950603`*^9, 3.636807889543457*^9}, {
  3.6368080539298596`*^9, 3.6368080670906124`*^9}, {3.6368081735757027`*^9, 
  3.6368081738317175`*^9}, {3.6368092169333797`*^9, 3.6368092972669744`*^9}, {
  3.63680934701782*^9, 3.636809372474276*^9}, {3.636809795939497*^9, 
  3.6368098139735284`*^9}, {3.6368108319497533`*^9, 3.636810842627364*^9}, {
  3.636810879694484*^9, 3.6368108828186626`*^9}, {3.636810933667571*^9, 
  3.6368109616741734`*^9}, {3.636811000303383*^9, 3.636811019164461*^9}, {
  3.636811157631381*^9, 3.636811177826536*^9}, {3.6368112758091407`*^9, 
  3.6368113205326986`*^9}, {3.636811451068165*^9, 3.6368114859911623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TransitiveClosure", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", "\"\<X\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", "\"\<Y\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", "\"\<t\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Y\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Z\>\"", ",", "\"\<Y\>\""}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.636811180406684*^9, 3.636811185494975*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"t\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"X\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"Y\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"Z\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"X\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"X\"\>", ",", "\<\"Z\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Y\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"Y\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6368111862300167`*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "EliminateUnitP"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EliminateUnitP", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"G2", "=", "G"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G2", "=", 
          RowBox[{"G2", "~", "Join", "~", 
           RowBox[{"Cases", "[", 
            RowBox[{"G", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", "x_"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "x"}], "}"}]}]}], "]"}]}]}], ")"}], "&"}], ",", 
       RowBox[{"TransitiveClosure", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"G", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringLength", "@", "#"}], "\[Equal]", "1"}], "&&", 
               RowBox[{"UpperCaseQ", "@", "#"}]}], "&"}], "@*", "Last"}]}], 
           "]"}], ",", 
          RowBox[{"Apply", "@", "Unequal"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Union", "@", 
      RowBox[{"Select", "[", 
       RowBox[{"G2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "@", 
            RowBox[{"Last", "@", "#"}]}], ">", "1"}], "||", 
          RowBox[{"!", 
           RowBox[{"UpperCaseQ", "@", 
            RowBox[{"Last", "@", "#"}]}]}]}], "&"}]}], "]"}]}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6368078825950603`*^9, 3.636807889543457*^9}, {
  3.6368080539298596`*^9, 3.6368080670906124`*^9}, {3.6368081735757027`*^9, 
  3.6368081738317175`*^9}, {3.6368092169333797`*^9, 3.6368092972669744`*^9}, {
  3.63680934701782*^9, 3.636809372474276*^9}, {3.636809795939497*^9, 
  3.6368098139735284`*^9}, {3.6368108319497533`*^9, 3.636810842627364*^9}, {
  3.636810879694484*^9, 3.6368108828186626`*^9}, {3.636810933667571*^9, 
  3.6368109616741734`*^9}, {3.636811000303383*^9, 3.636811019164461*^9}, {
  3.636811157631381*^9, 3.636811177826536*^9}, {3.6368115209611626`*^9, 
  3.6368115671868067`*^9}, {3.6368118251585617`*^9, 3.636811831560928*^9}, {
  3.6368120983371863`*^9, 3.636812280964632*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"BNF", "/@", 
   RowBox[{"ComposeList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "EliminateNullableP", ",", "EliminateUnitP", ",", "EliminateUselessP"}],
       "}"}], ",", 
     RowBox[{"G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6368132056765227`*^9, 3.6368132399314823`*^9}, {
  3.6368132799287696`*^9, 3.636813322456202*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] ABbaDS|S|Cb|A|C|aJ\"\>", 
       ",", "\<\"A \[Rule] S|BC|b|F|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] ac|ac|ac\"\>", ",", "\<\"C \[Rule] S|D\"\>", 
       ",", "\<\"E \[Rule] abS|cc\"\>", ",", "\<\"F \[Rule] A\"\>", 
       ",", "\<\"G \[Rule] H|H|G\"\>", ",", "\<\"H \[Rule] G|I|H|abc\"\>", 
       ",", "\<\"J \[Rule] J\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A \[Rule] b|B|BC|F|S\"\>", ",", "\<\"B \[Rule] ac\"\>", 
       ",", "\<\"C \[Rule] D|S\"\>", ",", "\<\"E \[Rule] ab|abS|cc\"\>", 
       ",", "\<\"F \[Rule] A\"\>", ",", "\<\"G \[Rule] G|H\"\>", 
       ",", "\<\"H \[Rule] abc|G|H|I\"\>", ",", "\<\"J \[Rule] J\"\>", 
       ",", "\<\"S \[Rule] A|ABbaD|ABbaDS|aJ|b|BbaD|BbaDS|C|Cb|S\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A \[Rule] ABbaD|ABbaDS|ac|aJ|b|BbaD|BbaDS|BC|Cb\"\>", 
       ",", "\<\"B \[Rule] ac\"\>", 
       ",", "\<\"C \[Rule] ABbaD|ABbaDS|ac|aJ|b|BbaD|BbaDS|BC|Cb\"\>", 
       ",", "\<\"E \[Rule] ab|abS|cc\"\>", 
       ",", "\<\"F \[Rule] ABbaD|ABbaDS|ac|aJ|b|BbaD|BbaDS|BC|Cb\"\>", 
       ",", "\<\"G \[Rule] abc\"\>", ",", "\<\"H \[Rule] abc\"\>", 
       ",", "\<\"S \[Rule] ABbaD|ABbaDS|ac|aJ|b|BbaD|BbaDS|BC|Cb\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"B \[Rule] ac\"\>", ",", "\<\"C \[Rule] ac|b|BC|Cb\"\>", 
       ",", "\<\"S \[Rule] ac|b|BC|Cb\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.6368132986978436`*^9, 3.636813323245247*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "SeparateVT"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SeparateVT", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "V", ",", "T", ",", "\[DoubleStruckCapitalV]", ",", 
      "\[DoubleStruckCapitalP]", ",", "G1", ",", "Tr", ",", "u", ",", "v"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      RowBox[{"Union", "@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"MapAtAllLast", "[", 
           RowBox[{"Characters", ",", "G"}], "]"}]}], ",", "UpperCaseQ"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Union", "@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"Characters", "@", 
           RowBox[{"G", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Not", "@*", "UpperCaseQ"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[DoubleStruckCapitalV]", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Characters", "@", 
          RowBox[{"FromCharacterCode", "@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"2", "^", "16"}], "-", "1"}], "]"}]}]}], ",", 
         "UpperCaseQ"}], "]"}], "\[Backslash]", "V"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[DoubleStruckCapitalP]", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"\[DoubleStruckCapitalV]", ",", 
           RowBox[{"Length", "@", "T"}]}], "]"}], ",", "T"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tr", "=", 
      RowBox[{
       RowBox[{"Reverse", "@*", "Rule"}], "@@@", 
       "\[DoubleStruckCapitalP]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[DoubleStruckCapitalP]", "~", "Join", "~", 
      RowBox[{"MapAtAllLast", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"UpperCaseQ", "@", "#"}]}], "&&", 
            RowBox[{
             RowBox[{"StringLength", "@", "#"}], ">", "1"}]}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"#", ",", "Tr"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
        "G"}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", 
  RowBox[{"BNF", "/@", 
   RowBox[{"ComposeList", "[", 
    RowBox[{
     RowBox[{"{", "SeparateVT", "}"}], ",", 
     RowBox[{"G", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6368143295288033`*^9, 3.6368143605565777`*^9}, {
  3.636814581955241*^9, 3.6368146451168537`*^9}, {3.6368149105530357`*^9, 
  3.636815058080474*^9}, {3.63681513511388*^9, 3.6368151424432993`*^9}, {
  3.6368152937269526`*^9, 3.636815303868532*^9}, {3.6368153460279436`*^9, 
  3.63681542008918*^9}, {3.636815451793993*^9, 3.6368157461148276`*^9}, {
  3.636815805229209*^9, 3.636815868463825*^9}, {3.636815917446627*^9, 
  3.6368159507815337`*^9}, {3.6368160064497175`*^9, 3.636816013288109*^9}, {
  3.6368160744736085`*^9, 3.636816075824686*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] ABbaDS|S|Cb|A|C|aJ\"\>", 
       ",", "\<\"A \[Rule] S|BC|b|F|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] ac|ac|ac\"\>", ",", "\<\"C \[Rule] S|D\"\>", 
       ",", "\<\"E \[Rule] abS|cc\"\>", ",", "\<\"F \[Rule] A\"\>", 
       ",", "\<\"G \[Rule] H|H|G\"\>", ",", "\<\"H \[Rule] G|I|H|abc\"\>", 
       ",", "\<\"J \[Rule] J\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] c\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] \[CurlyEpsilon]\"\>", 
       ",", "\<\"S \[Rule] AB\[FormalCapitalB]\[FormalCapitalA]DS|S|C\
\[FormalCapitalB]|A|C|\[FormalCapitalA]J\"\>", 
       ",", "\<\"A \[Rule] S|BC|b|F|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] \[FormalCapitalA]\[FormalCapitalC]|\
\[FormalCapitalA]\[FormalCapitalC]|\[FormalCapitalA]\[FormalCapitalC]\"\>", 
       ",", "\<\"C \[Rule] S|D\"\>", 
       ",", "\<\"E \[Rule] \[FormalCapitalA]\[FormalCapitalB]S|\
\[FormalCapitalC]\[FormalCapitalC]\"\>", ",", "\<\"F \[Rule] A\"\>", 
       ",", "\<\"G \[Rule] H|H|G\"\>", 
       ",", "\<\"H \[Rule] G|I|H|\[FormalCapitalA]\[FormalCapitalB]\
\[FormalCapitalC]\"\>", ",", "\<\"J \[Rule] J\"\>"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.636815058846518*^9, 3.6368151478656096`*^9, 3.636815305152606*^9, 
   3.6368154340319777`*^9, {3.6368155454283485`*^9, 3.6368155614832673`*^9}, {
   3.6368156391797113`*^9, 3.6368156628730664`*^9}, {3.6368157388104095`*^9, 
   3.636815748044938*^9}, {3.636815859049287*^9, 3.6368158689748545`*^9}, {
   3.6368159352166433`*^9, 3.636815951487574*^9}, 3.636816013728134*^9, 
   3.6368160770217543`*^9, 3.636818006577612*^9, 3.636826781020481*^9, 
   3.63682686019401*^9, 3.636827062614588*^9, 3.6368271400760183`*^9, 
   3.63694866340488*^9, 3.6380022185639153`*^9, 3.641534497174364*^9, 
   3.6416289231908307`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "CNF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CNF", "@", "G_"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[DoubleStruckCapitalG]", ",", "V", ",", "\[DoubleStruckCapitalV]", ",",
       "u", ",", "v", ",", "i", ",", "r", ",", 
      RowBox[{"ans", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[DoubleStruckCapitalG]", "=", 
      RowBox[{"SeparateVT", "@", 
       RowBox[{"EliminateUselessP", "@", 
        RowBox[{"EliminateUnitP", "@", 
         RowBox[{"EliminateNullableP", "@", "G"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[DoubleStruckCapitalV]", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Characters", "@", 
          RowBox[{"FromCharacterCode", "@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"2", "^", "16"}], "-", "1"}], "]"}]}]}], ",", 
         "UpperCaseQ"}], "]"}], "\[Backslash]", 
       RowBox[{"Union", "@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"MapAtAllLast", "[", 
            RowBox[{"Characters", ",", "\[DoubleStruckCapitalG]"}], "]"}]}], 
          ",", "UpperCaseQ"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"Reap", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v"}], "}"}], "=", "#"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Sow", "@", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"UpperCaseQ", "@", "v"}]}], "||", 
                  RowBox[{
                   RowBox[{"StringLength", "@", "v"}], "\[Equal]", "2"}]}], 
                 ",", 
                 RowBox[{"{", "#", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"V", "=", 
                   RowBox[{"\[DoubleStruckCapitalV]", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+=", 
                    RowBox[{
                    RowBox[{"StringLength", "@", "v"}], "-", "2"}]}], ")"}], 
                    "-", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Thread", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"V", ",", "u"}], "]"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"StringJoin", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Characters", "@", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"v", ",", "2"}], "]"}]}], ",", "V"}], "}"}]}]}], 
                    ",", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"v", ",", "2"}], "]"}]}], "]"}]}], "}"}]}]}]}], 
                "\[IndentingNewLine]", "]"}]}]}], ")"}], "&"}], ",", 
           "\[DoubleStruckCapitalG]"}], "]"}]}]}], ",", "2"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636816108156535*^9, 3.636816138383264*^9}, {
  3.636816198707714*^9, 3.636816286187718*^9}, {3.6368163551456623`*^9, 
  3.6368163556966934`*^9}, {3.6368163976910954`*^9, 3.6368164865596724`*^9}, {
  3.636816581741116*^9, 3.6368167683017864`*^9}, {3.6368168672394457`*^9, 
  3.6368169148151665`*^9}, {3.6368169623868876`*^9, 3.6368169914325485`*^9}, {
  3.6368170272535977`*^9, 3.636817081929725*^9}, {3.636817256197693*^9, 
  3.6368173377453566`*^9}, {3.636817456391143*^9, 3.6368175502415113`*^9}, {
  3.636817580680252*^9, 3.6368175871896243`*^9}, {3.636817637204485*^9, 
  3.636817747827812*^9}, {3.6368178668416195`*^9, 3.636817925783991*^9}, {
  3.6368179589078856`*^9, 3.636817979689074*^9}, {3.636818028804883*^9, 
  3.63681804360073*^9}, {3.6368181295126433`*^9, 3.6368181320907907`*^9}, {
  3.636818263674317*^9, 3.636818390166552*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"BNF", "/@", 
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"CNF", "@", "#"}]}], "}"}]}], "&"}], "/@", "G"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.636816108156535*^9, 3.636816138383264*^9}, {
  3.636816198707714*^9, 3.636816286187718*^9}, {3.6368163551456623`*^9, 
  3.6368163556966934`*^9}, {3.6368163976910954`*^9, 3.6368164865596724`*^9}, {
  3.636816581741116*^9, 3.6368167683017864`*^9}, {3.6368168672394457`*^9, 
  3.6368169148151665`*^9}, {3.6368169623868876`*^9, 3.6368169914325485`*^9}, {
  3.6368170272535977`*^9, 3.636817081929725*^9}, {3.636817256197693*^9, 
  3.6368173377453566`*^9}, {3.636817456391143*^9, 3.6368175502415113`*^9}, {
  3.636817580680252*^9, 3.6368175871896243`*^9}, {3.636817637204485*^9, 
  3.636817747827812*^9}, {3.6368178668416195`*^9, 3.636817925783991*^9}, {
  3.6368179589078856`*^9, 3.636817979689074*^9}, {3.636818028804883*^9, 
  3.63681804360073*^9}, {3.6368181295126433`*^9, 3.6368181320907907`*^9}, {
  3.636818263674317*^9, 3.636818390166552*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] ABbaDS|S|Cb|A|C|aJ\"\>", 
       ",", "\<\"A \[Rule] S|BC|b|F|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] ac|ac|ac\"\>", ",", "\<\"C \[Rule] S|D\"\>", 
       ",", "\<\"E \[Rule] abS|cc\"\>", ",", "\<\"F \[Rule] A\"\>", 
       ",", "\<\"G \[Rule] H|H|G\"\>", ",", "\<\"H \[Rule] G|I|H|abc\"\>", 
       ",", "\<\"J \[Rule] J\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] c\"\>", 
       ",", "\<\"B \[Rule] \[FormalCapitalA]\[FormalCapitalC]\"\>", 
       ",", "\<\"C \[Rule] \[FormalCapitalA]\[FormalCapitalC]|b|BC|C\
\[FormalCapitalB]\"\>", 
       ",", "\<\"S \[Rule] \[FormalCapitalA]\[FormalCapitalC]|b|BC|C\
\[FormalCapitalB]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] a|Xb|aYa\"\>", 
       ",", "\<\"X \[Rule] Y|\[CurlyEpsilon]\"\>", 
       ",", "\<\"Y \[Rule] b|X\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] a|\[FormalCapitalA]\[FormalCapitalA]|\
\[FormalCapitalA]Y|b|X\[FormalCapitalB]\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] \[FormalCapitalA]\[FormalCapitalC]\
\"\>", ",", "\<\"X \[Rule] b\"\>", ",", "\<\"Y \[Rule] b\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] SS|AB|b\"\>", ",", "\<\"B \[Rule] SB|b\"\>", 
       ",", "\<\"A \[Rule] a\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", ",", "\<\"A \[Rule] a\"\>",
        ",", "\<\"B \[Rule] b|SB\"\>", ",", "\<\"S \[Rule] AB|b|SS\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", "\<\"S \[Rule] aSa|bSb|\[CurlyEpsilon]\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] \[FormalCapitalA]\[FormalCapitalA]|\
\[FormalCapitalA]S|\[FormalCapitalB]\[FormalCapitalB]|\[FormalCapitalB]S\"\>",
        ",", "\<\"\[FormalCapitalC] \[Rule] \
\[FormalCapitalA]\[FormalCapitalC]\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] \[FormalCapitalB]\[FormalCapitalD]\
\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] a|Xb|aYa\"\>", 
       ",", "\<\"X \[Rule] Y|\[CurlyEpsilon]\"\>", 
       ",", "\<\"Y \[Rule] b|X\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] a|\[FormalCapitalA]\[FormalCapitalA]|\
\[FormalCapitalA]Y|b|X\[FormalCapitalB]\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] \[FormalCapitalA]\[FormalCapitalC]\
\"\>", ",", "\<\"X \[Rule] b\"\>", ",", "\<\"Y \[Rule] b\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] XY\"\>", ",", "\<\"X \[Rule] Zb\"\>", 
       ",", "\<\"Y \[Rule] bW\"\>", ",", "\<\"Z \[Rule] AB\"\>", 
       ",", "\<\"W \[Rule] Z\"\>", 
       ",", "\<\"A \[Rule] aA|bA|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] Ba|Bb|\[CurlyEpsilon]\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"A \[Rule] a|\[FormalCapitalA]A|b|\[FormalCapitalB]A\"\>", 
       ",", "\<\"B \[Rule] a|b|B\[FormalCapitalA]|B\[FormalCapitalB]\"\>", 
       ",", "\<\"S \[Rule] XY\"\>", 
       ",", "\<\"W \[Rule] a|\[FormalCapitalA]A|AB|b|\[FormalCapitalB]A|B\
\[FormalCapitalA]|B\[FormalCapitalB]\"\>", 
       ",", "\<\"X \[Rule] b|Z\[FormalCapitalB]\"\>", 
       ",", "\<\"Y \[Rule] b|\[FormalCapitalB]W\"\>", 
       ",", "\<\"Z \[Rule] a|\[FormalCapitalA]A|AB|b|\[FormalCapitalB]A|B\
\[FormalCapitalA]|B\[FormalCapitalB]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] Xab|YY|aX|ZYX\"\>", 
       ",", "\<\"X \[Rule] Za|bZ|ZZ|Yb\"\>", 
       ",", "\<\"Y \[Rule] Ya|XY|\[CurlyEpsilon]\"\>", 
       ",", "\<\"Z \[Rule] aX|YYY\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] a|\[FormalCapitalA]\[FormalCapitalB]|\
\[FormalCapitalA]X|b|\[FormalCapitalB]Z|X\[FormalCapitalA]|XY|Y\
\[FormalCapitalA]|Y\[FormalCapitalB]|YX|YY|YY|Z\[FormalCapitalA]|ZX|ZY|ZY|ZZ\"\
\>", ",", "\<\"\[FormalCapitalC] \[Rule] \[FormalCapitalB]\[FormalCapitalC]\"\
\>", ",", "\<\"\[FormalCapitalD] \[Rule] Y\[FormalCapitalD]\"\>", 
       ",", "\<\"\[FormalCapitalE] \[Rule] X\[FormalCapitalE]\"\>", 
       ",", "\<\"X \[Rule] a|\[FormalCapitalA]X|b|\[FormalCapitalB]Z|XY|Y\
\[FormalCapitalA]|Y\[FormalCapitalB]|YY|YY|Z\[FormalCapitalA]|ZZ\"\>", 
       ",", "\<\"\[FormalCapitalF] \[Rule] Y\[FormalCapitalF]\"\>", 
       ",", "\<\"Y \[Rule] a|\[FormalCapitalA]X|b|\[FormalCapitalB]Z|XY|Y\
\[FormalCapitalA]|Y\[FormalCapitalB]|YY|YY|Z\[FormalCapitalA]|ZZ\"\>", 
       ",", "\<\"\[FormalCapitalG] \[Rule] Y\[FormalCapitalG]\"\>", 
       ",", "\<\"Z \[Rule] a|\[FormalCapitalA]X|b|\[FormalCapitalB]Z|XY|Y\
\[FormalCapitalA]|Y\[FormalCapitalB]|YY|YY|Z\[FormalCapitalA]|ZZ\"\>", 
       ",", "\<\"\[FormalCapitalH] \[Rule] Y\[FormalCapitalH]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] A|bb\"\>", ",", "\<\"A \[Rule] B|b\"\>", 
       ",", "\<\"B \[Rule] S|a\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] a|b|\[FormalCapitalB]\[FormalCapitalB]\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] XY\"\>", ",", "\<\"X \[Rule] XX|A\"\>", 
       ",", "\<\"Y \[Rule] YY|B\"\>", ",", "\<\"A \[Rule] a\"\>", 
       ",", "\<\"B \[Rule] b\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] XY\"\>", ",", "\<\"X \[Rule] a|XX\"\>", 
       ",", "\<\"Y \[Rule] b|YY\"\>"}], "}"}]},
    {
     RowBox[{"{", "\<\"S \[Rule] aSa|bSb|a|b|\[CurlyEpsilon]\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] a|\[FormalCapitalA]\[FormalCapitalA]|\
\[FormalCapitalA]S|b|\[FormalCapitalB]\[FormalCapitalB]|\[FormalCapitalB]S\"\>\
", ",", "\<\"\[FormalCapitalC] \[Rule] \
\[FormalCapitalA]\[FormalCapitalC]\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] \[FormalCapitalB]\[FormalCapitalD]\
\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] bA|aB\"\>", ",", "\<\"A \[Rule] bAA|aS|a\"\>", 
       ",", "\<\"B \[Rule] aBB|bS|b\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", 
       ",", "\<\"A \[Rule] a|\[FormalCapitalA]S|\[FormalCapitalB]A\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] A\[FormalCapitalC]\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] B\[FormalCapitalD]\"\>", 
       ",", "\<\"B \[Rule] \[FormalCapitalA]B|b|\[FormalCapitalB]S\"\>", 
       ",", "\<\"S \[Rule] \[FormalCapitalA]B|\[FormalCapitalB]A\"\>"}], 
      "}"}]},
    {
     RowBox[{"{", "\<\"S \[Rule] aaaaS|aaaa\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] \[FormalCapitalA]\[FormalCapitalB]\
\"\>", ",", "\<\"\[FormalCapitalC] \[Rule] \[FormalCapitalA]\[FormalCapitalC]\
\"\>", ",", "\<\"S \[Rule] \[FormalCapitalA]\[FormalCapitalA]|\
\[FormalCapitalA]\[FormalCapitalA]\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] \[FormalCapitalA]\[FormalCapitalD]\
\"\>", ",", "\<\"\[FormalCapitalE] \[Rule] \[FormalCapitalA]\[FormalCapitalE]\
\"\>", ",", "\<\"\[FormalCapitalF] \[Rule] S\[FormalCapitalF]\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] ABABA\"\>", 
       ",", "\<\"A \[Rule] a|\[CurlyEpsilon]\"\>", 
       ",", "\<\"B \[Rule] b|\[CurlyEpsilon]\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", ",", "\<\"A \[Rule] a\"\>",
        ",", "\<\"B \[Rule] b\"\>", 
       ",", "\<\"S \[Rule] \
a|AA|AA|AA|AA|AB|AB|AB|AB|AB|AB|AB|b|BA|BA|BA|BA|BB|BB\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] A\[FormalCapitalC]\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] B\[FormalCapitalD]\"\>", 
       ",", "\<\"\[FormalCapitalE] \[Rule] B\[FormalCapitalE]\"\>", 
       ",", "\<\"\[FormalCapitalF] \[Rule] A\[FormalCapitalF]\"\>", 
       ",", "\<\"\[FormalCapitalG] \[Rule] A\[FormalCapitalG]\"\>", 
       ",", "\<\"\[FormalCapitalH] \[Rule] A\[FormalCapitalH]\"\>", 
       ",", "\<\"\[FormalCapitalI] \[Rule] A\[FormalCapitalI]\"\>", 
       ",", "\<\"\[FormalCapitalJ] \[Rule] A\[FormalCapitalJ]\"\>", 
       ",", "\<\"\[FormalCapitalK] \[Rule] B\[FormalCapitalK]\"\>", 
       ",", "\<\"\[FormalCapitalL] \[Rule] A\[FormalCapitalL]\"\>", 
       ",", "\<\"\[FormalCapitalM] \[Rule] B\[FormalCapitalM]\"\>", 
       ",", "\<\"\[FormalCapitalN] \[Rule] A\[FormalCapitalN]\"\>", 
       ",", "\<\"\[FormalCapitalO] \[Rule] B\[FormalCapitalO]\"\>", 
       ",", "\<\"\[FormalCapitalP] \[Rule] B\[FormalCapitalP]\"\>", 
       ",", "\<\"\[FormalCapitalQ] \[Rule] A\[FormalCapitalQ]\"\>", 
       ",", "\<\"\[FormalCapitalR] \[Rule] A\[FormalCapitalR]\"\>", 
       ",", "\<\"\[FormalCapitalS] \[Rule] B\[FormalCapitalS]\"\>", 
       ",", "\<\"\[FormalCapitalT] \[Rule] B\[FormalCapitalT]\"\>", 
       ",", "\<\"\[FormalCapitalU] \[Rule] A\[FormalCapitalU]\"\>", 
       ",", "\<\"\[FormalCapitalV] \[Rule] A\[FormalCapitalV]\"\>"}], "}"}]},
    {
     RowBox[{"{", "\<\"S \[Rule] SS|a\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"S \[Rule] a|SS\"\>"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"S \[Rule] SS|AB|b\"\>", ",", "\<\"B \[Rule] SB|b\"\>", 
       ",", "\<\"A \[Rule] a\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] b\"\>", ",", "\<\"A \[Rule] a\"\>",
        ",", "\<\"B \[Rule] b|SB\"\>", ",", "\<\"S \[Rule] AB|b|SS\"\>"}], 
      "}"}]},
    {
     RowBox[{
     "{", "\<\"S \[Rule] (S)|(S*S)|(S+S)|(S\[Rule]S)|(S/S)|(a)|(b)\"\>", 
      "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"\[FormalCapitalA] \[Rule] *\"\>", 
       ",", "\<\"\[FormalCapitalB] \[Rule] (\"\>", 
       ",", "\<\"\[FormalCapitalC] \[Rule] )\"\>", 
       ",", "\<\"\[FormalCapitalD] \[Rule] +\"\>", 
       ",", "\<\"\[FormalCapitalE] \[Rule] /\"\>", 
       ",", "\<\"\[FormalCapitalF] \[Rule] a\"\>", 
       ",", "\<\"\[FormalCapitalG] \[Rule] b\"\>", 
       ",", "\<\"\[FormalCapitalH] \[Rule] \[Rule]\"\>", 
       ",", "\<\"\[FormalCapitalI] \[Rule] \[FormalCapitalC]\[FormalCapitalI]\
\"\>", ",", "\<\"S \[Rule] \[FormalCapitalB]\[FormalCapitalF]|\
\[FormalCapitalB]\[FormalCapitalG]|\[FormalCapitalB]S|\[FormalCapitalB]S|\
\[FormalCapitalB]S|\[FormalCapitalB]S|\[FormalCapitalB]S\"\>", 
       ",", "\<\"\[FormalCapitalJ] \[Rule] \[FormalCapitalC]\[FormalCapitalJ]\
\"\>", ",", "\<\"\[FormalCapitalK] \[Rule] \[FormalCapitalC]\[FormalCapitalK]\
\"\>", ",", "\<\"\[FormalCapitalL] \[Rule] \[FormalCapitalA]\[FormalCapitalL]\
\"\>", ",", "\<\"\[FormalCapitalM] \[Rule] S\[FormalCapitalM]\"\>", 
       ",", "\<\"\[FormalCapitalN] \[Rule] \[FormalCapitalC]\[FormalCapitalN]\
\"\>", ",", "\<\"\[FormalCapitalO] \[Rule] \[FormalCapitalD]\[FormalCapitalO]\
\"\>", ",", "\<\"\[FormalCapitalP] \[Rule] S\[FormalCapitalP]\"\>", 
       ",", "\<\"\[FormalCapitalQ] \[Rule] \[FormalCapitalC]\[FormalCapitalQ]\
\"\>", ",", "\<\"\[FormalCapitalR] \[Rule] \[FormalCapitalE]\[FormalCapitalR]\
\"\>", ",", "\<\"\[FormalCapitalS] \[Rule] S\[FormalCapitalS]\"\>", 
       ",", "\<\"\[FormalCapitalT] \[Rule] \[FormalCapitalC]\[FormalCapitalT]\
\"\>", ",", "\<\"\[FormalCapitalU] \[Rule] \[FormalCapitalH]\[FormalCapitalU]\
\"\>", ",", "\<\"\[FormalCapitalV] \[Rule] S\[FormalCapitalV]\"\>", 
       ",", "\<\"\[FormalCapitalW] \[Rule] \[FormalCapitalC]\[FormalCapitalW]\
\"\>"}], "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.6368162870217657`*^9, 3.636816356420735*^9, {3.6368164421411314`*^9, 
   3.6368164884517803`*^9}, 3.636816777569317*^9, 3.636816917926345*^9, {
   3.6368170750063295`*^9, 3.636817089741172*^9}, 3.636817273928707*^9, 
   3.636817369076149*^9, 3.6368174896720467`*^9, 3.6368175536237044`*^9, {
   3.6368177408484135`*^9, 3.6368177510839987`*^9}, {3.6368179180025454`*^9, 
   3.6368179287391596`*^9}, {3.6368180214314613`*^9, 3.6368180606347036`*^9}, 
   3.636818134856949*^9, 3.636818289656803*^9, 3.6368183456460056`*^9}]
}, Closed]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "CKY"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CKY", "[", 
   RowBox[{"w_", ",", "G_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "T", ",", "n", ",", "f"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Cases", "[", 
          RowBox[{"G", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"A_", ",", "#"}], "}"}], "\[Rule]", "A"}]}], "]"}], 
         "}"}], "&"}], "/@", 
       RowBox[{"Characters", "@", "w"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"StringLength", "@", "w"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"T", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"Union", "@", 
          RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"f", "=", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"Outer", "[", 
                  RowBox[{"StringJoin", ",", 
                   RowBox[{"T", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "#"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"T", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "#"}], ",", 
                    RowBox[{"j", "+", "1", "-", "#"}]}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"First", "/@", 
                RowBox[{"Select", "[", 
                 RowBox[{"G", ",", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"f", ",", 
                    RowBox[{"Last", "@", "#"}]}], "]"}], "&"}]}], "]"}]}]}], 
              ")"}], "&"}], "/@", 
            RowBox[{"Range", "@", "j"}]}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "j"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "T"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636818843547484*^9, 3.6368188465486555`*^9}, {
   3.636822679332878*^9, 3.636822730090781*^9}, {3.636822768997007*^9, 
   3.6368227905522394`*^9}, {3.636822849772627*^9, 3.6368228557099667`*^9}, {
   3.636822900675538*^9, 3.636822903096677*^9}, {3.6368229353645225`*^9, 
   3.6368229393497505`*^9}, {3.6368230194433317`*^9, 3.63682303148002*^9}, {
   3.6368230984728518`*^9, 3.6368231567041826`*^9}, 3.6368233991910515`*^9, {
   3.636823431486899*^9, 3.6368234603275485`*^9}, {3.6368235015569067`*^9, 
   3.636823561179317*^9}, {3.63682364462809*^9, 3.6368236735527444`*^9}, {
   3.6368237828429956`*^9, 3.636823788589324*^9}, {3.6368238327568502`*^9, 
   3.6368238589873505`*^9}, {3.636823904126932*^9, 3.63682390933223*^9}, {
   3.636824065419158*^9, 3.6368240665842247`*^9}, {3.6368242833466225`*^9, 
   3.6368242835196323`*^9}, {3.6368243296242695`*^9, 3.636824340736905*^9}, {
   3.636824582077709*^9, 3.636824588958102*^9}, {3.636824830932943*^9, 
   3.6368248627327614`*^9}, {3.6368249031030703`*^9, 3.6368249032550793`*^9}, 
   3.6368249491527042`*^9, {3.6368261062778883`*^9, 3.6368261108441496`*^9}, 
   3.6368268295522575`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "@", 
  RowBox[{"CKY", "[", 
   RowBox[{"\"\<ababa\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<S\>\"", ",", "\"\<AB\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<A\>\"", ",", "\"\<BC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<A\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<B\>\"", ",", "\"\<AC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<B\>\"", ",", "\"\<b\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<C\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<C\>\"", ",", "\"\<b\>\""}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.636818843547484*^9, 3.6368188465486555`*^9}, {
   3.636822679332878*^9, 3.636822730090781*^9}, {3.636822768997007*^9, 
   3.6368227905522394`*^9}, {3.636822849772627*^9, 3.6368228557099667`*^9}, {
   3.636822900675538*^9, 3.636822903096677*^9}, {3.6368229353645225`*^9, 
   3.6368229393497505`*^9}, {3.6368230194433317`*^9, 3.63682303148002*^9}, {
   3.6368230984728518`*^9, 3.6368231567041826`*^9}, 3.6368233991910515`*^9, {
   3.636823431486899*^9, 3.6368234603275485`*^9}, {3.6368235015569067`*^9, 
   3.636823561179317*^9}, {3.63682364462809*^9, 3.6368236735527444`*^9}, {
   3.6368237828429956`*^9, 3.636823788589324*^9}, {3.6368238327568502`*^9, 
   3.6368238589873505`*^9}, {3.636823904126932*^9, 3.63682390933223*^9}, {
   3.636824065419158*^9, 3.6368240665842247`*^9}, {3.6368242833466225`*^9, 
   3.6368242835196323`*^9}, {3.6368243296242695`*^9, 3.636824340736905*^9}, {
   3.636824582077709*^9, 3.636824588958102*^9}, {3.636824830932943*^9, 
   3.6368248627327614`*^9}, {3.6368249031030703`*^9, 3.6368249032550793`*^9}, 
   3.6368249491527042`*^9, {3.6368261062778883`*^9, 3.6368261108441496`*^9}, 
   3.6368268295522575`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"C\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}], ""},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"C\"\>"}], "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"S\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}], "", ""},
    {
     RowBox[{"{", 
      RowBox[{"\<\"B\"\>", ",", "\<\"C\"\>"}], "}"}], 
     RowBox[{"{", "\<\"A\"\>", "}"}], "", "", ""},
    {
     RowBox[{"{", 
      RowBox[{"\<\"A\"\>", ",", "\<\"C\"\>"}], "}"}], "", "", "", ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.63682279405544*^9, 3.636822857987097*^9, 3.636822905457812*^9, 
   3.6368229579628153`*^9, {3.636823022162487*^9, 3.636823031918045*^9}, 
   3.636823157342219*^9, 3.6368234150149565`*^9, 3.6368235519917917`*^9, 
   3.6368236836073194`*^9, 3.6368237895923815`*^9, {3.636823836054039*^9, 
   3.636823840474292*^9}, 3.6368239097312527`*^9, {3.636824325874055*^9, 
   3.6368243448741417`*^9}, 3.6368245914252434`*^9, 3.636824905086184*^9, 
   3.636824949584729*^9, 3.636826128065134*^9, 3.6368268360936313`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "@", "ParseCKY"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParseCKY", "[", 
   RowBox[{"w_", ",", "G_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"V", "=", 
       RowBox[{"CKY", "[", 
        RowBox[{"w", ",", "G"}], "]"}]}], ",", "parse"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"V", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
          "\"\<S\>\""}], "]"}]}], ",", 
       RowBox[{"Return", "@", 
        RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"parse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}], ",", "A_"}], "]"}], ":=", 
      RowBox[{"FirstPosition", "[", 
       RowBox[{"G", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"w", ",", 
            RowBox[{"{", "i", "}"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"parse", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], ",", "A_"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k", "=", 
          RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "=", 
              RowBox[{"First", "@", 
               RowBox[{"FirstPosition", "[", 
                RowBox[{"G", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"X_", ",", "x_"}], "}"}], "/;", 
                  RowBox[{
                   RowBox[{"X", "==", "A"}], "&&", 
                   RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Outer", "[", 
                    RowBox[{"StringJoin", ",", 
                    RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", 
                    RowBox[{"k", "-", "i"}]}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"V", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", 
                    RowBox[{"j", "-", "k", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", "x"}], 
                    "]"}]}]}]}], "]"}]}]}], ")"}], "==", "\"\<NotFound\>\""}],
            ",", 
           RowBox[{"k", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "p", "}"}], ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"parse", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "j"}], "}"}]}], "}"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"G", "\[LeftDoubleBracket]", 
                   RowBox[{"p", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}], "}"}]}], "]"}]}], "}"}]}], 
             "]"}]}]}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"parse", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"StringLength", "@", "w"}]}], "}"}], ",", "\"\<S\>\""}], 
      "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.636825096583137*^9, 3.636825131289122*^9}, {
   3.6368251667201486`*^9, 3.6368252907182407`*^9}, {3.636825325721243*^9, 
   3.636825325879252*^9}, {3.636825404538751*^9, 3.6368254879575224`*^9}, {
   3.636825534234169*^9, 3.636825540202511*^9}, {3.6368255794677563`*^9, 
   3.636825647857668*^9}, {3.6368256959274178`*^9, 3.6368257475563707`*^9}, {
   3.6368257818443317`*^9, 3.636825787443652*^9}, {3.636825848389138*^9, 
   3.6368258756556973`*^9}, 3.636825947989835*^9, {3.636826074886093*^9, 
   3.6368260981664248`*^9}, {3.6368261926778297`*^9, 3.636826259136631*^9}, {
   3.6368265669772387`*^9, 3.636826629682825*^9}, {3.6368266774165554`*^9, 
   3.6368267003638678`*^9}, {3.6368267954423065`*^9, 3.63682680372578*^9}, {
   3.6368268889666557`*^9, 3.636826907084692*^9}, {3.6368269447908487`*^9, 
   3.636827012513722*^9}, {3.6368270580953293`*^9, 3.636827109187251*^9}, {
   3.6368272112060866`*^9, 3.6368272392176886`*^9}, {3.636827317616173*^9, 
   3.6368273541312613`*^9}, {3.636827515446488*^9, 3.636827561552125*^9}, {
   3.6368276238186865`*^9, 3.636827740157341*^9}, {3.636827777170458*^9, 
   3.6368278075661964`*^9}, {3.636827937603634*^9, 3.6368281607683983`*^9}, 
   3.6368283242267475`*^9, {3.636828423661435*^9, 3.636828455375249*^9}, {
   3.6368286345054946`*^9, 3.6368287192993445`*^9}, {3.636828749399066*^9, 
   3.636828872284095*^9}, {3.6368289768570757`*^9, 3.6368290499812584`*^9}, {
   3.6368291546212435`*^9, 3.6368291696431026`*^9}, {3.6368292564960704`*^9, 
   3.636829302977729*^9}, {3.636829469001225*^9, 3.6368295030191708`*^9}, {
   3.636829564171668*^9, 3.6368295921862707`*^9}, {3.6368296622182765`*^9, 
   3.6368296708847723`*^9}, {3.6368297062087927`*^9, 3.636829724289827*^9}, {
   3.63682983186298*^9, 3.6368298834219284`*^9}, 3.636829942205291*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"#", "\[LeftDoubleBracket]", 
    RowBox[{"ParseCKY", "[", 
     RowBox[{"\"\<abab\>\"", ",", "#"}], "]"}], "\[RightDoubleBracket]"}], 
   "&"}], "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", "\"\<AB\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<A\>\"", ",", "\"\<BC\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<A\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<B\>\"", ",", "\"\<AC\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<B\>\"", ",", "\"\<b\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<C\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<C\>\"", ",", "\"\<b\>\""}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"$RecursionLimit", "=", "20"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "\[LeftDoubleBracket]", 
      RowBox[{"ParseCKY", "[", 
       RowBox[{"\"\<ababa\>\"", ",", "#"}], "]"}], "\[RightDoubleBracket]"}], 
     "&"}], "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<S\>\"", ",", "\"\<AB\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<A\>\"", ",", "\"\<BC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<A\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<B\>\"", ",", "\"\<AC\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<B\>\"", ",", "\"\<b\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<C\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<C\>\"", ",", "\"\<b\>\""}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.636825096583137*^9, 3.636825131289122*^9}, {
   3.6368251667201486`*^9, 3.6368252907182407`*^9}, {3.636825325721243*^9, 
   3.636825325879252*^9}, {3.636825404538751*^9, 3.6368254879575224`*^9}, {
   3.636825534234169*^9, 3.636825540202511*^9}, {3.6368255794677563`*^9, 
   3.636825647857668*^9}, {3.6368256959274178`*^9, 3.6368257475563707`*^9}, {
   3.6368257818443317`*^9, 3.636825787443652*^9}, {3.636825848389138*^9, 
   3.6368258756556973`*^9}, 3.636825947989835*^9, {3.636826074886093*^9, 
   3.6368260981664248`*^9}, {3.6368261926778297`*^9, 3.636826259136631*^9}, {
   3.6368265669772387`*^9, 3.636826629682825*^9}, {3.6368266774165554`*^9, 
   3.6368267003638678`*^9}, {3.6368267954423065`*^9, 3.63682680372578*^9}, {
   3.6368268889666557`*^9, 3.636826907084692*^9}, {3.6368269447908487`*^9, 
   3.636827012513722*^9}, {3.6368270580953293`*^9, 3.636827109187251*^9}, {
   3.6368272112060866`*^9, 3.6368272392176886`*^9}, {3.636827317616173*^9, 
   3.6368273541312613`*^9}, {3.636827515446488*^9, 3.636827561552125*^9}, {
   3.6368276238186865`*^9, 3.636827740157341*^9}, {3.636827777170458*^9, 
   3.6368278075661964`*^9}, {3.636827937603634*^9, 3.6368281607683983`*^9}, 
   3.6368283242267475`*^9, {3.636828423661435*^9, 3.636828455375249*^9}, {
   3.6368286345054946`*^9, 3.6368287192993445`*^9}, {3.636828749399066*^9, 
   3.636828872284095*^9}, {3.6368289768570757`*^9, 3.6368290499812584`*^9}, {
   3.6368291546212435`*^9, 3.6368291696431026`*^9}, {3.6368292564960704`*^9, 
   3.636829302977729*^9}, {3.636829469001225*^9, 3.6368295030191708`*^9}, {
   3.636829564171668*^9, 3.6368295921862707`*^9}, {3.6368296622182765`*^9, 
   3.6368296708847723`*^9}, {3.6368297062087927`*^9, 3.636829724289827*^9}, {
   3.63682983186298*^9, 3.6368298834219284`*^9}, 3.636829942205291*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"S\"\>", ",", "\<\"AB\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"B\"\>", ",", "\<\"AC\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A\"\>", ",", "\<\"BC\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"B\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"C\"\>", ",", "\<\"b\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6368270637206507`*^9, {3.6368272207056303`*^9, 3.6368272397197175`*^9}, {
   3.6368273501460333`*^9, 3.636827361140662*^9}, {3.63682770569937*^9, 
   3.6368278080812263`*^9}, {3.6368280578995147`*^9, 
   3.6368280680290937`*^9}, {3.636828100743965*^9, 3.636828110928548*^9}, 
   3.636828292747947*^9, 3.6368283275439377`*^9, 3.636828433135977*^9, {
   3.636828700079245*^9, 3.6368287204134083`*^9}, {3.636828753290289*^9, 
   3.6368288043732104`*^9}, {3.6368288401372557`*^9, 3.636828874723234*^9}, {
   3.6368290409187403`*^9, 3.636829052891425*^9}, {3.6368291706351595`*^9, 
   3.6368291878511443`*^9}, 3.6368295053733053`*^9, 3.6368295418473916`*^9, 
   3.6368295957134724`*^9, 3.6368296731168995`*^9, 3.6368297252638826`*^9, 
   3.636829845279747*^9, 3.6368298841249685`*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.6368270637206507`*^9, {3.6368272207056303`*^9, 3.6368272397197175`*^9}, {
   3.6368273501460333`*^9, 3.636827361140662*^9}, {3.63682770569937*^9, 
   3.6368278080812263`*^9}, {3.6368280578995147`*^9, 
   3.6368280680290937`*^9}, {3.636828100743965*^9, 3.636828110928548*^9}, 
   3.636828292747947*^9, 3.6368283275439377`*^9, 3.636828433135977*^9, {
   3.636828700079245*^9, 3.6368287204134083`*^9}, {3.636828753290289*^9, 
   3.6368288043732104`*^9}, {3.6368288401372557`*^9, 3.636828874723234*^9}, {
   3.6368290409187403`*^9, 3.636829052891425*^9}, {3.6368291706351595`*^9, 
   3.6368291878511443`*^9}, 3.6368295053733053`*^9, 3.6368295418473916`*^9, 
   3.6368295957134724`*^9, 3.6368296731168995`*^9, 3.6368297252638826`*^9, 
   3.636829845279747*^9, 3.636829884126969*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"w", "\[Function]", 
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"ParseCKY", "[", 
           RowBox[{"w", ",", "#"}], "]"}], "\[RightDoubleBracket]"}], "&"}], 
        "@", 
        RowBox[{"CNF", "@", 
         RowBox[{"Pairs", "@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<S\[Rule]bS\>\"", ",", "\"\<S\[Rule]abaK\>\"", ",", 
            "\"\<K\[Rule]bbK\>\"", ",", "\"\<K\[Rule]abK\>\"", ",", 
            "\"\<K\[Rule]ab\>\""}], "}"}]}]}]}]}], "}"}]}], ")"}], "/@", 
   RowBox[{"{", 
    RowBox[{
    "\"\<abaab\>\"", ",", "\"\<babaab\>\"", ",", "\"\<abaabab\>\"", ",", 
     "\"\<bbabba\>\"", ",", "\"\<aababab\>\"", ",", "\"\<bbaabbbab\>\""}], 
    "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6368299639215326`*^9, 3.636830038717811*^9}, {
   3.6368301259948025`*^9, 3.636830242264453*^9}, 3.636830379029276*^9, {
   3.6368304131242256`*^9, 3.636830506301555*^9}, 3.6368308041015882`*^9, {
   3.6368308486231346`*^9, 3.6368308488031454`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"\<\"abaab\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"babaab\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"abaabab\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"bbabba\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"aababab\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"\<\"bbaabbbab\"\>", ",", 
       RowBox[{"{", "}"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.636830004867875*^9, 3.636830039241841*^9}, {
   3.636830212250736*^9, 3.636830243945549*^9}, 3.6368303803743525`*^9, {
   3.6368304146973157`*^9, 3.6368304322533197`*^9}, {3.6368304884195323`*^9, 
   3.6368305084026756`*^9}, 3.6368308063907194`*^9, 3.636830855395522*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "@", 
  RowBox[{"CKY", "[", 
   RowBox[{"\"\<abaab\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<\[FormalCapitalA]\>\"", ",", "\"\<a\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\[FormalCapitalB]\>\"", ",", "\"\<b\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<K\>\"", ",", "\"\<\[FormalCapitalA]\[FormalCapitalB]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[FormalCapitalC]\>\"", ",", "\"\<K\[FormalCapitalC]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<K\>\"", ",", "\"\<\[FormalCapitalA]\[FormalCapitalB]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[FormalCapitalD]\>\"", ",", "\"\<K\[FormalCapitalD]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<K\>\"", ",", "\"\<\[FormalCapitalB]\[FormalCapitalB]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[FormalCapitalE]\>\"", ",", 
        "\"\<\[FormalCapitalA]\[FormalCapitalE]\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\[FormalCapitalF]\>\"", ",", "\"\<K\[FormalCapitalF]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<S\>\"", ",", "\"\<\[FormalCapitalA]\[FormalCapitalB]\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<S\>\"", ",", "\"\<\[FormalCapitalB]S\>\""}], "}"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.636830264773741*^9, 3.6368302737552547`*^9}, {
  3.6368303108753777`*^9, 3.6368303213089743`*^9}, {3.6368305370163116`*^9, 
  3.636830592771501*^9}, {3.6368308198364887`*^9, 3.6368308221816225`*^9}, {
  3.6368308614178667`*^9, 3.63683087546167*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", "\<\"\[FormalCapitalA]\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"K\"\>", ",", "\<\"S\"\>"}], "}"}], 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}]},
    {
     RowBox[{"{", "\<\"\[FormalCapitalB]\"\>", "}"}], 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}], ""},
    {
     RowBox[{"{", "\<\"\[FormalCapitalA]\"\>", "}"}], 
     RowBox[{"{", "}"}], 
     RowBox[{"{", "}"}], "", ""},
    {
     RowBox[{"{", "\<\"\[FormalCapitalA]\"\>", "}"}], 
     RowBox[{"{", 
      RowBox[{"\<\"K\"\>", ",", "\<\"S\"\>"}], "}"}], "", "", ""},
    {
     RowBox[{"{", "\<\"\[FormalCapitalB]\"\>", "}"}], "", "", "", ""}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.636830267874918*^9, 3.636830274309286*^9}, 
   3.6368303396320224`*^9, {3.6368305541692934`*^9, 3.636830597190754*^9}, 
   3.6368308236127043`*^9, 3.636830876076705*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w", "\[Function]", 
      RowBox[{"{", 
       RowBox[{"w", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"ParseCKY", "[", 
            RowBox[{"w", ",", "#"}], "]"}], "\[RightDoubleBracket]"}], "&"}], 
         "@", 
         RowBox[{"CNF", "@", 
          RowBox[{"Pairs", "@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<S \[Rule] SJ\>\"", ",", "\"\<J \[Rule] JS\>\"", ",", 
             "\"\<S \[Rule] ab\>\"", ",", "\"\<J \[Rule] ba\>\""}], 
            "}"}]}]}]}]}], "}"}]}], ")"}], "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<abbaab\>\"", ",", "\"\<baba\>\"", ",", "\"\<abbababa\>\"", ",", 
      "\"\<baab\>\"", ",", "\"\<abba\>\""}], "}"}]}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6368309477818065`*^9, 3.636831046220437*^9}, 
   3.636831096263299*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"abbaab\"\>", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", 
         ",", "\<\"\[FormalCapitalA]\[FormalCapitalB]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", ",", "\<\"JS\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", 
         ",", "\<\"\[FormalCapitalB]\[FormalCapitalA]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", 
         ",", "\<\"\[FormalCapitalA]\[FormalCapitalB]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}]}], 
      "}"}]},
    {"\<\"baba\"\>", 
     RowBox[{"{", "}"}]},
    {"\<\"abbababa\"\>", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", 
         ",", "\<\"\[FormalCapitalA]\[FormalCapitalB]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", 
         ",", "\<\"\[FormalCapitalB]\[FormalCapitalA]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", 
         ",", "\<\"\[FormalCapitalB]\[FormalCapitalA]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", 
         ",", "\<\"\[FormalCapitalB]\[FormalCapitalA]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}]}], 
      "}"}]},
    {"\<\"baab\"\>", 
     RowBox[{"{", "}"}]},
    {"\<\"abba\"\>", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", ",", "\<\"SJ\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"S\"\>", 
         ",", "\<\"\[FormalCapitalA]\[FormalCapitalB]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"J\"\>", 
         ",", "\<\"\[FormalCapitalB]\[FormalCapitalA]\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalB]\"\>", ",", "\<\"b\"\>"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\<\"\[FormalCapitalA]\"\>", ",", "\<\"a\"\>"}], "}"}]}], 
      "}"}]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.636831023982165*^9, 3.636831047252496*^9}, 
   3.636831147412225*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["LALR(1) Parsing", "Subchapter",
 CellChangeTimes->{{3.641534454213907*^9, 3.64153447280497*^9}}],

Cell[TextData[Cell[BoxData[
 TagBox[
  ButtonBox[
   PaneSelectorBox[{
    False->"\<\"http://web.cs.dal.ca/~sjackson/lalr1.html\"\>", True->
    StyleBox["\<\"http://web.cs.dal.ca/~sjackson/lalr1.html\"\>", 
     "HyperlinkActive"]}, Dynamic[
     CurrentValue["MouseOver"]],
    BaseStyle->{"Hyperlink"},
    FrameMargins->0,
    ImageSize->Automatic],
   BaseStyle->"Hyperlink",
   ButtonData->{
     URL["http://web.cs.dal.ca/~sjackson/lalr1.html"], None},
   ButtonNote->"http://web.cs.dal.ca/~sjackson/lalr1.html"],
  Annotation[#, "http://web.cs.dal.ca/~sjackson/lalr1.html", "Hyperlink"]& ]],
 CellChangeTimes->{3.6415344972943707`*^9}]], "Text",
 CellChangeTimes->{3.641534502758683*^9}],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.6415427510374575`*^9, 3.6415427531765804`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"this", " ", "is", " ", 
    RowBox[{"craziness", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LALR1ParseExample", "[", "\[Omega]_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "S", ",", "C", ",", "V", ",", "D", ",", "P", ",", "w", ",", 
        "f"}], "}"}], ","}]}], "*)"}], 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAll", "[", 
      RowBox[{
      "NS", ",", "NC", ",", "NV", ",", "ND", ",", "NP", ",", "i", ",", "w", 
       ",", "ws", ",", "f", ",", "inc"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"w", "[", "i__", "]"}], ":=", 
      RowBox[{"Sow", "@", 
       RowBox[{"Check", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{"{", "i", "}"}]}], "]"}], ",", "\"\<\>\""}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<S\>\"", "\[Rule]", 
         RowBox[{"{", "\"\<if\>\"", "}"}]}], ",", 
        RowBox[{"\"\<V\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", "\"\<c\>\""}], "}"}]}], 
        ",", 
        RowBox[{"\"\<D\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<1\>\"", ",", "\"\<2\>\"", ",", "\"\<3\>\""}], 
          "}"}]}]}], "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "@", "\"\<P\>\""}], "=", 
      RowBox[{
       RowBox[{"f", "@", "\"\<C\>\""}], "=", 
       RowBox[{"Union", "@@", 
        RowBox[{"(", 
         RowBox[{"f", "/@", 
          RowBox[{"{", 
           RowBox[{"\"\<S\>\"", ",", "\"\<V\>\""}], "}"}]}], ")"}]}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"inc", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"++", "i"}], ";", "True"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ws", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"StringLength", "@", "\[Omega]"}]}], "&&", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}], "\[Equal]", "\"\< \>\""}]}], 
          ",", 
          RowBox[{
           RowBox[{"Sow", "[", "\"\< \>\"", "]"}], ";", 
           RowBox[{"++", "i"}]}]}], "]"}], ";", "True"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NS", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sow", "@", "\"\<S\>\""}], ";", 
        RowBox[{
         RowBox[{"And", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<if\>\"", "\[Equal]", 
            RowBox[{"w", "[", 
             RowBox[{"i", ",", 
              RowBox[{"++", "i"}]}], "]"}]}], ",", 
           RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ws", "[", "]"}], ",", 
           RowBox[{"NC", "[", "]"}], ",", 
           RowBox[{"ws", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<then\>\"", "\[Equal]", 
            RowBox[{"w", "[", 
             RowBox[{"i", ",", 
              RowBox[{"i", "+=", "3"}]}], "]"}]}], ",", 
           RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ws", "[", "]"}], ",", 
           RowBox[{"NP", "[", "]"}], ",", 
           RowBox[{"ws", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<else\>\"", "\[Equal]", 
            RowBox[{"w", "[", 
             RowBox[{"i", ",", 
              RowBox[{"i", "+=", "3"}]}], "]"}]}], ",", 
           RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ws", "[", "]"}], ",", 
           RowBox[{"NP", "[", "]"}], ",", 
           RowBox[{"ws", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<;\>\"", "\[Equal]", 
            RowBox[{"w", "[", "i", "]"}]}], ",", 
           RowBox[{"inc", "[", "]"}], ",", 
           RowBox[{"ws", "[", "]"}]}], "]"}], "\[IndentingNewLine]", "||", 
         RowBox[{"Return", "[", "\"\<error NS\>\"", "]"}]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NC", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sow", "@", "\"\<C\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"And", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NV", "[", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Or", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<\[LessEqual]\>\"", ",", "\"\<\[GreaterEqual]\>\""}], 
               "}"}], ",", 
              RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "\"\<error NC\>\"", "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NV", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], ")"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NV", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sow", "@", "\"\<V\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"And", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Or", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"f", "@", "\"\<V\>\""}], ",", 
              RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "\"\<error NV\>\"", "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ND", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], ")"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ND", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sow", "@", "\"\<D\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"And", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Or", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"f", "@", "\"\<D\>\""}], ",", 
              RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "\"\<error ND\>\"", "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"f", "@", "\"\<D\>\""}], ",", 
               RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"++", "i"}], ";", 
              RowBox[{"ND", "[", "]"}]}]}], "]"}], ";", "True"}]}], 
         "\[IndentingNewLine]", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NP", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sow", "@", "\"\<P\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"Or", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"f", "@", "\"\<V\>\""}], ",", 
              RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"And", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NV", "[", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<:=\>\"", "\[Equal]", 
               RowBox[{"w", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"++", "i"}]}], "]"}]}], ",", 
              RowBox[{"inc", "[", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Or", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"And", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"f", "@", "\"\<V\>\""}], ",", 
                    RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
                  RowBox[{"NV", "[", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"And", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"f", "@", "\"\<D\>\""}], ",", 
                    RowBox[{"w", "[", "i", "]"}]}], "]"}], ",", 
                  RowBox[{"ND", "[", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Return", "[", "\"\<error NP1\>\"", "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}],
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"f", "@", "\"\<S\>\""}], ",", 
             RowBox[{"w", "[", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}]}], "]"}], "&&", 
           RowBox[{"NS", "[", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "\"\<error NP2\>\"", "]"}]}], "]"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NS", "[", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6415438725656056`*^9, 3.6415439402974796`*^9}, {
   3.6415440188159704`*^9, 3.6415443867310143`*^9}, {3.6415457536171956`*^9, 
   3.64154581087047*^9}, {3.6415458459974794`*^9, 3.6415458813605022`*^9}, {
   3.6415460255007467`*^9, 3.6415460294699736`*^9}, {3.641546349862299*^9, 
   3.6415464966076922`*^9}, {3.641546533227787*^9, 3.6415465479646297`*^9}, {
   3.641546635582641*^9, 3.641546648245365*^9}, {3.641546926331271*^9, 
   3.641547194528611*^9}, {3.641547274391179*^9, 3.641547307362065*^9}, {
   3.641547339300892*^9, 3.641547394312038*^9}, {3.6415475068324738`*^9, 
   3.6415475281806946`*^9}, {3.6415476405941243`*^9, 3.641547653756877*^9}, {
   3.6415476911350155`*^9, 3.641547746399176*^9}, {3.641547798624163*^9, 
   3.6415478239326105`*^9}, 3.6415478585785923`*^9, {3.641547898131855*^9, 
   3.6415479703849874`*^9}, {3.641548012166377*^9, 3.641548064191353*^9}, {
   3.641548109760959*^9, 3.6415482558823166`*^9}, {3.641548302035957*^9, 
   3.6415483026389914`*^9}, {3.6415483473835506`*^9, 3.641548357907152*^9}, {
   3.641548407248975*^9, 3.6415487167586775`*^9}, {3.641548955230317*^9, 
   3.641548958981532*^9}, {3.641549017475878*^9, 3.641549024767295*^9}, {
   3.641549065789641*^9, 3.641549157314876*^9}, {3.6415491965581207`*^9, 
   3.6415492357033596`*^9}, {3.6415492657890806`*^9, 3.641549328178649*^9}, {
   3.641549465723516*^9, 3.6415495754057894`*^9}, {3.6415496487709856`*^9, 
   3.6415496525642023`*^9}, {3.6415497153827953`*^9, 
   3.6415497313077064`*^9}, {3.641549812052325*^9, 3.6415498132783947`*^9}, {
   3.6415500104496727`*^9, 3.6415500122447753`*^9}, {3.6415500477378054`*^9, 
   3.641550355930433*^9}, {3.6415504057312813`*^9, 3.641550413473724*^9}, {
   3.641550565037393*^9, 3.6415505850815396`*^9}, {3.6415506173023825`*^9, 
   3.6415507654650784`*^9}, {3.6415507957728114`*^9, 3.641550807007454*^9}, {
   3.6415508716761527`*^9, 3.641550884493886*^9}, {3.641550919496888*^9, 
   3.641550949441601*^9}, {3.6415517426259685`*^9, 3.6415519252464137`*^9}, {
   3.641552532477145*^9, 3.6415525916295285`*^9}, {3.6415526789605236`*^9, 
   3.6415526990456724`*^9}, {3.6415527458003464`*^9, 
   3.6415527493995523`*^9}, {3.6415528693694143`*^9, 3.641552869802439*^9}, {
   3.641553175021897*^9, 3.641553419701892*^9}, {3.6416290720613456`*^9, 
   3.6416291134737144`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reap", "@", 
  RowBox[{
  "LALR1ParseExample", "[", 
   "\"\<if a2\[LessEqual]b2 then a2:=a1 else a2:=c3;\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.6415472221881933`*^9, 3.641547264333604*^9}, {
   3.6415475554952574`*^9, 3.641547555978285*^9}, {3.6415477567537684`*^9, 
   3.64154775713179*^9}, {3.641548176146756*^9, 3.6415481769708033`*^9}, {
   3.641549400375778*^9, 3.6415494329146395`*^9}, 3.6415495819321623`*^9, {
   3.6415496608956795`*^9, 3.6415496745454597`*^9}, 3.641549841506009*^9, {
   3.6415534267402945`*^9, 3.641553434868759*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"S\"\>", ",", "\<\"if\"\>", ",", "\<\" \"\>", 
      ",", "\<\"C\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"2\"\>", ",", "\<\"\[LessEqual]\"\>", 
      ",", "\<\"\[LessEqual]\"\>", ",", "\<\"V\"\>", ",", "\<\"b\"\>", 
      ",", "\<\"D\"\>", ",", "\<\"2\"\>", ",", "\<\" \"\>", ",", "\<\" \"\>", 
      ",", "\<\"then\"\>", ",", "\<\" \"\>", ",", "\<\"P\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"2\"\>", ",", "\<\":\"\>", ",", "\<\":=\"\>", ",", "\<\"a\"\>",
       ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", ",", "\<\"1\"\>",
       ",", "\<\" \"\>", ",", "\<\" \"\>", ",", "\<\"else\"\>", 
      ",", "\<\" \"\>", ",", "\<\"P\"\>", ",", "\<\"a\"\>", ",", "\<\"V\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"D\"\>", ",", "\<\"2\"\>", ",", "\<\":\"\>", 
      ",", "\<\":=\"\>", ",", "\<\"c\"\>", ",", "\<\"V\"\>", ",", "\<\"c\"\>",
       ",", "\<\"D\"\>", ",", "\<\"3\"\>", ",", "\<\";\"\>", 
      ",", "\<\";\"\>"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6415472677047963`*^9, 3.641547277139336*^9}, 
   3.6415473126093645`*^9, 3.6415473964541607`*^9, {3.641547515906993*^9, 
   3.641547558557432*^9}, {3.641547752723538*^9, 3.6415477624200926`*^9}, 
   3.6415478281418514`*^9, 3.641547860609709*^9, {3.641547949834812*^9, 
   3.6415479720740843`*^9}, {3.641548021033884*^9, 3.6415480682195835`*^9}, 
   3.6415481774078283`*^9, {3.6415482309778924`*^9, 3.6415482577964263`*^9}, 
   3.641548305221139*^9, 3.641548360264287*^9, {3.6415485228965893`*^9, 
   3.6415485607867565`*^9}, 3.641548602303131*^9, {3.6415486707770476`*^9, 
   3.6415486878050213`*^9}, 3.641548968841096*^9, 3.641549027182433*^9, {
   3.641549084913735*^9, 3.64154915930799*^9}, {3.641549200668356*^9, 
   3.6415492389105425`*^9}, {3.6415492696523013`*^9, 
   3.6415492916135573`*^9}, {3.6415494054310675`*^9, 3.641549425690226*^9}, {
   3.641549561186976*^9, 3.6415495835612555`*^9}, {3.6415496578715057`*^9, 
   3.6415496752424994`*^9}, 3.64154974028222*^9, {3.641549816036553*^9, 
   3.64154984221305*^9}, {3.6415501199349346`*^9, 3.641550145320387*^9}, 
   3.641550181978483*^9, {3.6415502277040987`*^9, 3.6415502533375645`*^9}, 
   3.641550309870798*^9, 3.6415503653809733`*^9, 3.6415504148818045`*^9, 
   3.641550622797697*^9, 3.6415507738015547`*^9, 3.641550808674549*^9, 
   3.6415508900482035`*^9, 3.6415509692577343`*^9, 3.6415517620550795`*^9, 
   3.6415519290576315`*^9, {3.6415525411706424`*^9, 3.6415525957207623`*^9}, 
   3.641552752654739*^9, 3.6415528759587913`*^9, 3.641553147055297*^9, {
   3.641553424104143*^9, 3.6415534402560673`*^9}, 3.641628928740148*^9, 
   3.641629077154637*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reap", "@", 
  RowBox[{
  "LALR1ParseExample", "[", 
   "\"\<if a123\[LessEqual]a321 then a123:=123 else a321:=321;\>\"", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6415498698856325`*^9, 3.641549903159536*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"S\"\>", ",", "\<\"if\"\>", ",", "\<\" \"\>", 
      ",", "\<\"C\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\"2\"\>", ",", "\<\"D\"\>", ",", "\<\"3\"\>", 
      ",", "\<\"\[LessEqual]\"\>", ",", "\<\"\[LessEqual]\"\>", 
      ",", "\<\"\[LessEqual]\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", 
      ",", "\<\"D\"\>", ",", "\<\"3\"\>", ",", "\<\"2\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\" \"\>", ",", "\<\" \"\>", ",", "\<\" \"\>", 
      ",", "\<\"then\"\>", ",", "\<\" \"\>", ",", "\<\"P\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\"2\"\>", ",", "\<\"D\"\>", ",", "\<\"3\"\>", 
      ",", "\<\":\"\>", ",", "\<\":\"\>", ",", "\<\":=\"\>", ",", "\<\"1\"\>",
       ",", "\<\"1\"\>", ",", "\<\"D\"\>", ",", "\<\"1\"\>", ",", "\<\"2\"\>",
       ",", "\<\"D\"\>", ",", "\<\"3\"\>", ",", "\<\" \"\>", ",", "\<\" \"\>",
       ",", "\<\" \"\>", ",", "\<\"else\"\>", ",", "\<\" \"\>", 
      ",", "\<\"P\"\>", ",", "\<\"a\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", 
      ",", "\<\"D\"\>", ",", "\<\"3\"\>", ",", "\<\"2\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\":\"\>", ",", "\<\":\"\>", ",", "\<\":=\"\>",
       ",", "\<\"3\"\>", ",", "\<\"3\"\>", ",", "\<\"D\"\>", ",", "\<\"3\"\>",
       ",", "\<\"2\"\>", ",", "\<\"D\"\>", ",", "\<\"1\"\>", ",", "\<\";\"\>",
       ",", "\<\";\"\>", ",", "\<\";\"\>"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.641549904744626*^9, 3.641550970424801*^9, 
  3.641553070715931*^9, 3.641553436845872*^9, 3.641628931208289*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reap", "@", 
  RowBox[{
  "LALR1ParseExample", "[", 
   "\"\<if c1\[LessEqual]b2 then if c2\[LessEqual]b3 then a1:=1 else a1:=2; \
else a1:=3;\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.641628932899386*^9, 3.6416290039274483`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\<\"S\"\>", ",", "\<\"if\"\>", ",", "\<\" \"\>", 
      ",", "\<\"C\"\>", ",", "\<\"V\"\>", ",", "\<\"c\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\"\[LessEqual]\"\>", 
      ",", "\<\"\[LessEqual]\"\>", ",", "\<\"V\"\>", ",", "\<\"b\"\>", 
      ",", "\<\"D\"\>", ",", "\<\"2\"\>", ",", "\<\" \"\>", ",", "\<\" \"\>", 
      ",", "\<\"then\"\>", ",", "\<\" \"\>", ",", "\<\"P\"\>", 
      ",", "\<\"i\"\>", ",", "\<\"if\"\>", ",", "\<\"S\"\>", 
      ",", "\<\"if\"\>", ",", "\<\" \"\>", ",", "\<\"C\"\>", ",", "\<\"V\"\>",
       ",", "\<\"c\"\>", ",", "\<\"D\"\>", ",", "\<\"2\"\>", 
      ",", "\<\"\[LessEqual]\"\>", ",", "\<\"\[LessEqual]\"\>", 
      ",", "\<\"V\"\>", ",", "\<\"b\"\>", ",", "\<\"D\"\>", ",", "\<\"3\"\>", 
      ",", "\<\" \"\>", ",", "\<\" \"\>", ",", "\<\"then\"\>", 
      ",", "\<\" \"\>", ",", "\<\"P\"\>", ",", "\<\"a\"\>", ",", "\<\"V\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"D\"\>", ",", "\<\"1\"\>", ",", "\<\":\"\>", 
      ",", "\<\":=\"\>", ",", "\<\"1\"\>", ",", "\<\"1\"\>", ",", "\<\"D\"\>",
       ",", "\<\"1\"\>", ",", "\<\" \"\>", ",", "\<\" \"\>", 
      ",", "\<\"else\"\>", ",", "\<\" \"\>", ",", "\<\"P\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"V\"\>", ",", "\<\"a\"\>", ",", "\<\"D\"\>", 
      ",", "\<\"1\"\>", ",", "\<\":\"\>", ",", "\<\":=\"\>", ",", "\<\"2\"\>",
       ",", "\<\"2\"\>", ",", "\<\"D\"\>", ",", "\<\"2\"\>", ",", "\<\";\"\>",
       ",", "\<\";\"\>", ",", "\<\" \"\>", ",", "\<\"else\"\>", 
      ",", "\<\" \"\>", ",", "\<\"P\"\>", ",", "\<\"a\"\>", ",", "\<\"V\"\>", 
      ",", "\<\"a\"\>", ",", "\<\"D\"\>", ",", "\<\"1\"\>", ",", "\<\":\"\>", 
      ",", "\<\":=\"\>", ",", "\<\"3\"\>", ",", "\<\"3\"\>", ",", "\<\"D\"\>",
       ",", "\<\"3\"\>", ",", "\<\";\"\>", ",", "\<\";\"\>"}], "}"}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{3.641629004567485*^9, 3.641629078923738*^9, 
  3.6416291178309636`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{778, 640},
WindowMargins->{{290, Automatic}, {Automatic, 32}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 126, 1, 62, "Subchapter"],
Cell[709, 25, 643, 13, 52, "Input",
 InitializationCell->True],
Cell[1355, 40, 2225, 55, 112, "Input",
 InitializationCell->True],
Cell[3583, 97, 2845, 66, 232, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[6453, 167, 862, 19, 31, "Input"],
Cell[7318, 188, 11867, 306, 278, "Output"]
}, Closed]],
Cell[19200, 497, 2387, 48, 106, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[21612, 549, 1280, 19, 31, "Input"],
Cell[22895, 570, 759, 11, 31, "Output"]
}, Closed]],
Cell[23669, 584, 641, 17, 46, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[24335, 605, 466, 11, 52, "Input"],
Cell[24804, 618, 163, 3, 31, "Output"],
Cell[24970, 623, 585, 16, 31, "Output"]
}, Closed]],
Cell[25570, 642, 3699, 73, 126, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[29294, 719, 2008, 29, 31, "Input"],
Cell[31305, 750, 349, 7, 31, "Output"]
}, Closed]],
Cell[31669, 760, 3105, 65, 175, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[34799, 829, 1428, 24, 52, "Input"],
Cell[36230, 855, 1004, 16, 31, "Output"],
Cell[37237, 873, 845, 14, 31, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[38119, 892, 441, 10, 25, "Input"],
Cell[38563, 904, 178, 4, 31, "Output"]
}, Closed]],
Cell[38756, 911, 2314, 57, 146, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[41095, 972, 693, 10, 31, "Input"],
Cell[41791, 984, 1385, 51, 252, "Output"]
}, Closed]],
Cell[43191, 1038, 4061, 102, 226, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[47277, 1144, 618, 15, 31, "Input"],
Cell[47898, 1161, 815, 16, 42, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[48750, 1182, 468, 13, 25, "Input"],
Cell[49221, 1197, 461, 11, 42, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[49719, 1213, 1190, 23, 46, "Input"],
Cell[50912, 1238, 994, 24, 57, "Output"]
}, Closed]],
Cell[51921, 1265, 2208, 51, 186, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[54154, 1320, 620, 16, 52, "Input"],
Cell[54777, 1338, 922, 25, 31, "Output"]
}, Closed]],
Cell[55714, 1366, 2612, 64, 126, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[58351, 1434, 468, 12, 52, "Input"],
Cell[58822, 1448, 1719, 37, 98, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[60578, 1490, 3341, 82, 226, "Input",
 InitializationCell->True],
Cell[63922, 1574, 2166, 41, 70, "Output"]
}, Open  ]],
Cell[66103, 1618, 4571, 103, 312, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[70699, 1725, 1195, 22, 31, "Input"],
Cell[71897, 1749, 13069, 250, 600, "Output"]
}, Closed]],
Cell[84981, 2002, 3607, 80, 206, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[88613, 2086, 1884, 36, 52, "Input"],
Cell[90500, 2124, 1658, 42, 87, "Output"]
}, Open  ]],
Cell[92173, 2169, 5928, 133, 312, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[98126, 2306, 3551, 74, 152, "Input"],
Cell[101680, 2382, 1385, 28, 31, "Output"],
Cell[103068, 2412, 847, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103952, 2430, 1195, 28, 132, "Input"],
Cell[105150, 2460, 1111, 34, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106298, 2499, 1776, 48, 77, "Input"],
Cell[108077, 2549, 1049, 30, 122, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109163, 2584, 995, 27, 112, "Input"],
Cell[110161, 2613, 4017, 99, 152, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[114227, 2718, 102, 1, 46, "Subchapter"],
Cell[114332, 2721, 696, 17, 31, "Text"],
Cell[CellGroupData[{
Cell[115053, 2742, 96, 1, 63, "Section"],
Cell[115152, 2745, 12069, 270, 1212, "Input"],
Cell[CellGroupData[{
Cell[127246, 3019, 577, 10, 31, "Input"],
Cell[127826, 3031, 2803, 42, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130666, 3078, 236, 6, 31, "Input"],
Cell[130905, 3086, 1735, 26, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132677, 3117, 259, 6, 52, "Input"],
Cell[132939, 3125, 2003, 32, 92, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
